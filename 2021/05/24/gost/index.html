<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>GO Simple Tunnel————GO语言实现的安全隧道 | EdNovas的小站</title><meta name="keywords" content="vps,gost,go simple tunnel"><meta name="author" content="EdNovas"><meta name="copyright" content="EdNovas"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="转载自https:&#x2F;&#x2F;docs.ginuerzh.xyz&#x2F;gost&#x2F;  功能特性多端口监听可设置转发代理，支持多级转发(代理链)支持标准HTTP&#x2F;HTTPS&#x2F;HTTP2&#x2F;SOCKS4(A)&#x2F;SOCKS5代理协议Web代理支持探测防御SOCKS5代理支持TLS协商加密支持多种隧道类型Tunnel UDP over TCP本地&#x2F;远程TCP&#x2F;UDP端口转发TCP&#x2F;UDP透明代理支持Shadowsock">
<meta property="og:type" content="article">
<meta property="og:title" content="GO Simple Tunnel————GO语言实现的安全隧道">
<meta property="og:url" content="https://ednovas.xyz/2021/05/24/gost/index.html">
<meta property="og:site_name" content="EdNovas的小站">
<meta property="og:description" content="转载自https:&#x2F;&#x2F;docs.ginuerzh.xyz&#x2F;gost&#x2F;  功能特性多端口监听可设置转发代理，支持多级转发(代理链)支持标准HTTP&#x2F;HTTPS&#x2F;HTTP2&#x2F;SOCKS4(A)&#x2F;SOCKS5代理协议Web代理支持探测防御SOCKS5代理支持TLS协商加密支持多种隧道类型Tunnel UDP over TCP本地&#x2F;远程TCP&#x2F;UDP端口转发TCP&#x2F;UDP透明代理支持Shadowsock">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/gosttunnel.png">
<meta property="article:published_time" content="2021-05-25T04:37:00.000Z">
<meta property="article:modified_time" content="2021-08-23T22:49:04.230Z">
<meta property="article:author" content="EdNovas">
<meta property="article:tag" content="vps">
<meta property="article:tag" content="gost">
<meta property="article:tag" content="go simple tunnel">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/gosttunnel.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/830.circled-e-filled1.png"><link rel="canonical" href="https://ednovas.xyz/2021/05/24/gost/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="O9Uxirs5RzGyHijDvBe5okX6j2BxdRrzjxKkGI34B18"/><meta name="msvalidate.01" content="5651177152477FB9B4EBC45053EECDA3"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#000000"/><link rel="apple-touch-icon" sizes="180x180" href="/image/siteicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/image/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/image/siteicon/16.png"/><link rel="mask-icon" href="/image/siteicon/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-185849872-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-185849872-1');
</script><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;d6704c4319ce48e883585dfd275af345&quot;}"></script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"59FQUQ1CBL","apiKey":"07dbe3620a56feffda190697671f0a93","indexName":"ednovas","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":30,"position":"top","messagePrev":"距离文章编辑已经过去了","messageNext":"天，实际情况可能有所变动。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-08-23 15:49:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/css/scrollbar.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_2440505_a5eo7su26z8.css"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="EdNovas的小站" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/icon.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">245</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">340</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://navigate.ednovas.xyz"><i class="fa-fw fas fa-home"></i><span> 主页 | Home</span></a></div><div class="menus_item"><a class="site-page" href="/random.html"><i class="fa-fw fas fa-random"></i><span> 随机 | Random</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录 | Categories</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 回忆 | Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签 | Tags</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-fufei"></i><span> 付费解锁 | Pay to Unlock</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page" target="_blank" rel="noopener" href="https://t.me/ednovas"><span> 如需解锁请联系EdNovas</span></a></li><li><a class="site-page" href="/vps/"><span> 自建VPS节点</span></a></li><li><a class="site-page" href="/urls/"><span> 付费订阅链接</span></a></li><li><a class="site-page" href="/ios/"><span> ios外区账号</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-pengyouquan"></i><span> 朋友圈 | Link</span></a></div><div class="menus_item"><a class="site-page" href="/%E6%94%AF%E6%8C%81/"><i class="fa-fw fas fa-heart"></i><span> 打赏支持 | Support</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">EdNovas的小站</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://navigate.ednovas.xyz"><i class="fa-fw fas fa-home"></i><span> 主页 | Home</span></a></div><div class="menus_item"><a class="site-page" href="/random.html"><i class="fa-fw fas fa-random"></i><span> 随机 | Random</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录 | Categories</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 回忆 | Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签 | Tags</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-fufei"></i><span> 付费解锁 | Pay to Unlock</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page" target="_blank" rel="noopener" href="https://t.me/ednovas"><span> 如需解锁请联系EdNovas</span></a></li><li><a class="site-page" href="/vps/"><span> 自建VPS节点</span></a></li><li><a class="site-page" href="/urls/"><span> 付费订阅链接</span></a></li><li><a class="site-page" href="/ios/"><span> ios外区账号</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-pengyouquan"></i><span> 朋友圈 | Link</span></a></div><div class="menus_item"><a class="site-page" href="/%E6%94%AF%E6%8C%81/"><i class="fa-fw fas fa-heart"></i><span> 打赏支持 | Support</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">GO Simple Tunnel————GO语言实现的安全隧道</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-05-25T04:37:00.000Z" title="Created 2021-05-24 21:37:00">2021-05-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-08-23T22:49:04.230Z" title="Updated 2021-08-23 15:49:04">2021-08-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/VPS/">VPS</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">11.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>45min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>转载自<a target="_blank" rel="noopener" href="https://docs.ginuerzh.xyz/gost/">https://docs.ginuerzh.xyz/gost/</a></p>
</blockquote>
<h1 id="功能特性"><a href="#功能特性" class="headerlink" title="功能特性"></a>功能特性</h1><p>多端口监听<br>可设置转发代理，支持多级转发(代理链)<br>支持标准HTTP/HTTPS/HTTP2/SOCKS4(A)/SOCKS5代理协议<br>Web代理支持探测防御<br>SOCKS5代理支持TLS协商加密<br>支持多种隧道类型<br>Tunnel UDP over TCP<br>本地/远程TCP/UDP端口转发<br>TCP/UDP透明代理<br>支持Shadowsocks(TCP/UDP)协议<br>支持SNI代理<br>权限控制<br>负载均衡<br>路由控制<br>DNS解析和代理<br>TUN/TAP设备</p>
<h1 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h1><h2 id="二进制文件"><a href="#二进制文件" class="headerlink" title="二进制文件"></a>二进制文件</h2><p><a target="_blank" rel="noopener" href="https://github.com/ginuerzh/gost/releases">https://github.com/ginuerzh/gost/releases</a></p>
<h2 id="源码编译"><a href="#源码编译" class="headerlink" title="源码编译"></a>源码编译</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;ginuerzh&#x2F;gost.git</span><br><span class="line">cd gost&#x2F;cmd&#x2F;gost</span><br><span class="line">go build</span><br></pre></td></tr></table></figure>
<h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker pull ginuerzh&#x2F;gost</span><br><span class="line">Ubuntu Store</span><br><span class="line">sudo snap install core</span><br><span class="line">sudo snap install gost</span><br></pre></td></tr></table></figure>
<h2 id="Shadowsocks-Android插件"><a href="#Shadowsocks-Android插件" class="headerlink" title="Shadowsocks Android插件"></a>Shadowsocks Android插件</h2><p><a target="_blank" rel="noopener" href="https://github.com/xausky/ShadowsocksGostPlugin">xausky/ShadowsocksGostPlugin</a></p>
<h1 id="问题建议"><a href="#问题建议" class="headerlink" title="问题建议"></a>问题建议</h1><p>提交Issue: <a target="_blank" rel="noopener" href="https://github.com/ginuerzh/gost/issues">https://github.com/ginuerzh/gost/issues</a></p>
<p>Telegram讨论群: <a target="_blank" rel="noopener" href="https://t.me/gogost">https://t.me/gogost</a></p>
<p>Google讨论组: <a target="_blank" rel="noopener" href="https://groups.google.com/d/forum/go-gost">https://groups.google.com/d/forum/go-gost</a></p>
<h1 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h1><blockquote>
<p>代理节点<br>在GOST中，GOST与其他代理服务都被看作是代理节点，GOST可以自己处理请求，或者将请求转发给任意一个或多个代理节点。</p>
</blockquote>
<h2 id="启动运行"><a href="#启动运行" class="headerlink" title="启动运行"></a>启动运行</h2><h2 id="开启代理服务"><a href="#开启代理服务" class="headerlink" title="开启代理服务"></a>开启代理服务</h2><p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/gost001.png"></p>
<p>启动一个监听在8080端口的HTTP/SOCKS5代理服务：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080</span><br></pre></td></tr></table></figure>
<h2 id="开启多个代理服务"><a href="#开启多个代理服务" class="headerlink" title="开启多个代理服务"></a>开启多个代理服务</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http2:&#x2F;&#x2F;:443 -L socks5:&#x2F;&#x2F;:1080 -L ss:&#x2F;&#x2F;aes-128-cfb:123456@:8338</span><br></pre></td></tr></table></figure>

<h2 id="使用转发代理"><a href="#使用转发代理" class="headerlink" title="使用转发代理"></a>使用转发代理</h2><p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/gost002.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F 192.168.1.1:8081</span><br></pre></td></tr></table></figure>
<p>监听在8080端口的HTTP/SOCKS5代理服务，使用192.168.1.1:8081作为上级代理进行转发。</p>
<h2 id="使用多级转发代理-代理链"><a href="#使用多级转发代理-代理链" class="headerlink" title="使用多级转发代理(代理链)"></a>使用多级转发代理(代理链)</h2><p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/gost003.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;quic:&#x2F;&#x2F;192.168.1.1:8081 -F&#x3D;socks5+wss:&#x2F;&#x2F;192.168.1.2:8082 -F&#x3D;http2:&#x2F;&#x2F;192.168.1.3:8083 ... -F&#x3D;a.b.c.d:NNNN</span><br></pre></td></tr></table></figure>
<p>GOST按照-F设置的顺序通过代理链将请求最终转发给a.b.c.d:NNNN处理。</p>
<h2 id="启动参数"><a href="#启动参数" class="headerlink" title="启动参数"></a>启动参数</h2><p>GOST目前有以下几个参数项：</p>
<p>-L - 指定本地服务配置，可设置多个。</p>
<p>-F - 指定转发服务配置，可设置多个，构成转发链。</p>
<p>-C - 指定外部配置文件。</p>
<p>-D - 开启Debug模式，更详细的日志输出。</p>
<p>-V - 查看版本，显示当前运行的gost版本号。</p>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>除了通过命令行直接配置服务外，也可以通过-C参数指定外部配置文件来设置参数：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -C gost.json</span><br></pre></td></tr></table></figure>
<p>配置文件为标准json格式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;Debug&quot;: true,</span><br><span class="line">    &quot;Retries&quot;: 0,</span><br><span class="line">    &quot;ServeNodes&quot;: [</span><br><span class="line">        &quot;:8080&quot;,</span><br><span class="line">        &quot;ss:&#x2F;&#x2F;chacha20:12345678@:8338&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;ChainNodes&quot;: [</span><br><span class="line">        &quot;http:&#x2F;&#x2F;192.168.1.1:8080&quot;,</span><br><span class="line">        &quot;https:&#x2F;&#x2F;10.0.2.1:443&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;Routes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Retries&quot;: 1,</span><br><span class="line">            &quot;ServeNodes&quot;: [</span><br><span class="line">                &quot;ws:&#x2F;&#x2F;:1443&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ChainNodes&quot;: [</span><br><span class="line">                &quot;socks:&#x2F;&#x2F;:192.168.1.1:1080&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Retries&quot;: 3,</span><br><span class="line">            &quot;ServeNodes&quot;: [</span><br><span class="line">                &quot;quic:&#x2F;&#x2F;:443&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>格式说明：</p>
<p>Debug - 对应命令行参数-D。(2.4+)</p>
<p>Retries - 通过代理链建立连接失败后的重试次数。(2.5+)</p>
<p>ServeNodes - 必须项，等同于命令行参数-L。</p>
<p>ChainNodes - 等同于命令行参数-F。</p>
<p>Routes - 可选参数，额外的服务列表，每一项都拥有独立的转发链。(2.5+)</p>
<h1 id="节点配置"><a href="#节点配置" class="headerlink" title="节点配置"></a>节点配置</h1><blockquote>
<p>逻辑分层<br>在GOST中一个代理服务逻辑上被分成两层：协议层(Protocol)和传输层(Transport)，每层有若干可选的类型，两层之间相互独立，并可以任意组合使用。</p>
</blockquote>
<p>当GOST去连接一个代理节点时，会先按照传输层设置的传输类型进行交互，当传输层建立以后，再按照协议层设置的协议类型进行交互。</p>
<h2 id="协议类型-Protocols"><a href="#协议类型-Protocols" class="headerlink" title="协议类型(Protocols)"></a>协议类型(Protocols)</h2><p>支持的协议类型有：</p>
<p>http - HTTP</p>
<p>http2 - HTTP2</p>
<p>socks4 - SOCKS4 (2.4+)</p>
<p>socks4a - SOCKS4A (2.4+)</p>
<p>socks5 - SOCKS5</p>
<p>ss - Shadowsocks</p>
<p>ss2 - Shadowsocks with AEAD support (2.8+)</p>
<p>sni - SNI (2.5+)</p>
<p>forward - Forward</p>
<p>relay - TCP/UDP relay (2.11+)</p>
<h2 id="传输类型-Transports"><a href="#传输类型-Transports" class="headerlink" title="传输类型(Transports)"></a>传输类型(Transports)</h2><p>支持的传输类型有：</p>
<p>tcp - 原始TCP</p>
<p>tls - TLS</p>
<p>mtls - Multiplex TLS，在TLS上增加多路复用功能 (2.5+)</p>
<p>ws - Websocket</p>
<p>mws - Multiplex Websocket，在Websocket上增加多路复用功能 (2.5+)</p>
<p>wss - Websocket Secure，基于TLS加密的Websocket</p>
<p>mwss - Multiplex Websocket Secure，在基于TLS加密的Websocket上增加多路复用功能 (2.5+)</p>
<p>kcp - KCP (2.3+)</p>
<p>quic - QUIC (2.4+)</p>
<p>ssh - SSH (2.4+)</p>
<p>h2 - HTTP2 (2.4+)</p>
<p>h2c - HTTP2 Cleartext (2.4+)</p>
<p>obfs4 - OBFS4 (2.4+)</p>
<p>ohttp - HTTP Obfuscation (2.7+)</p>
<p>otls - TLS Obfuscation (2.11+)</p>
<h2 id="配置格式"><a href="#配置格式" class="headerlink" title="配置格式"></a>配置格式</h2><p>端口转发相关的节点配置格式请参考端口转发。</p>
<p>在GOST中节点的配置为类URL格式(适用于-L和-F参数)：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[scheme:&#x2F;&#x2F;][user:pass@host]:port[?param1&#x3D;value1&amp;param2&#x3D;value2]</span><br></pre></td></tr></table></figure>
<h2 id="scheme"><a href="#scheme" class="headerlink" title="scheme"></a>scheme</h2><p>scheme可以是单独的协议类型或传输类型，或是二者的组合，也可以是空。</p>
<h2 id="不指定任何类型"><a href="#不指定任何类型" class="headerlink" title="不指定任何类型"></a>不指定任何类型</h2><p>传输层默认为是原始TCP类型。</p>
<p>对于-L参数，协议层默认为是HTTP &amp; SOCKS5，对于-F参数，协议层默认为是HTTP类型。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F :8888</span><br></pre></td></tr></table></figure>
<h2 id="仅指定协议类型"><a href="#仅指定协议类型" class="headerlink" title="仅指定协议类型"></a>仅指定协议类型</h2><p>当仅指定协议类型时，传输层默认为原始TCP类型。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http:&#x2F;&#x2F;:8080 -F socks5:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<h2 id="仅指定传输类型"><a href="#仅指定传输类型" class="headerlink" title="仅指定传输类型"></a>仅指定传输类型</h2><p>当仅指定传输类型时，对于-L参数，协议类型默认为HTTP+SOCKS5。对于-F参数，协议层默认为是HTTP类型。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tls:&#x2F;&#x2F;:443 -F ws:&#x2F;&#x2F;:1443</span><br></pre></td></tr></table></figure>

<h2 id="组合使用"><a href="#组合使用" class="headerlink" title="组合使用"></a>组合使用</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http+tls:&#x2F;&#x2F;:443 -F socks5+wss:&#x2F;&#x2F;:1443</span><br></pre></td></tr></table></figure>

<h2 id="特殊的schemes"><a href="#特殊的schemes" class="headerlink" title="特殊的schemes"></a>特殊的schemes</h2><p>除了上述的类型外，有几个比较特殊的shemes：</p>
<p>https - 简写形式，等同于http+tls</p>
<p>redirect - TCP透明代理 (2.3+)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L redirect:&#x2F;&#x2F;:12345</span><br></pre></td></tr></table></figure>
<p>ssu - Shadowsocks UDP relay</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L ssu:&#x2F;&#x2F;chacha20:123456@:8338</span><br></pre></td></tr></table></figure>
<h2 id="节点认证"><a href="#节点认证" class="headerlink" title="节点认证"></a>节点认证</h2><h2 id="user-pass"><a href="#user-pass" class="headerlink" title="user:pass"></a>user:pass</h2><p>通过user:pass指定服务的认证信息。对于shadowsocks，user为加密类型。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L admin:123456@:8080 -F ss:&#x2F;&#x2F;chacha20:123456@:8338</span><br></pre></td></tr></table></figure>
<h2 id="auth参数-2-9-2"><a href="#auth参数-2-9-2" class="headerlink" title="auth参数 (2.9.2+)"></a>auth参数 (2.9.2+)</h2><p>如果认证信息中包含特殊字符，则可以通过auth参数来设置：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080?auth&#x3D;YWRtaW46MTIzNDU2 -F ss:&#x2F;&#x2F;:8338?auth&#x3D;Y2hhY2hhMjA6QWEjJiEkMTIzNEA1Njc4</span><br></pre></td></tr></table></figure>

<p>auth的值为user:passbase64编码值</p>
<h2 id="secrets参数"><a href="#secrets参数" class="headerlink" title="secrets参数"></a>secrets参数</h2><p>也可以通过secrets参数来设定多组认证信息：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080?secrets&#x3D;secrets.txt</span><br></pre></td></tr></table></figure>
<p>secrets.txt文件格式为按行分割的认证信息，每一行认证信息为用空格分割的user-pass对，以 # 开始的行为注释行。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># period for live reloading</span><br><span class="line">reload      10s</span><br><span class="line"></span><br><span class="line"># username password</span><br><span class="line"></span><br><span class="line">admin           #123456</span><br><span class="line">test\user001    123456</span><br><span class="line">test.user@002   12345678</span><br></pre></td></tr></table></figure>
<p>reload - 此配置文件支持热更新。此选项用来指定文件检查周期，默认关闭热更新。</p>
<p>注意： 当secrets参数用于shadowsocks协议时，仅会使用第一项作为认证信息。</p>
<blockquote>
<p>所有的认证信息都是用于协议层(Protocol)。</p>
</blockquote>
<h1 id="HTTPS-S"><a href="#HTTPS-S" class="headerlink" title="HTTPS(S)"></a>HTTPS(S)</h1><p>HTTP是GOST支持的一种协议类型(Protocol)，配合各种传输类型(Transport)可以很灵活的构建代理服务：</p>
<h2 id="标准HTTP代理服务"><a href="#标准HTTP代理服务" class="headerlink" title="标准HTTP代理服务"></a>标准HTTP代理服务</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http:&#x2F;&#x2F;:8080</span><br></pre></td></tr></table></figure>
<p>这是一种最基本的也是最普遍使用的代理服务类型，本身没有任何加密机制。</p>
<h2 id="标准HTTPS代理服务"><a href="#标准HTTPS代理服务" class="headerlink" title="标准HTTPS代理服务"></a>标准HTTPS代理服务</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L https:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<p>使用了TLS加密的HTTP代理服务。</p>
<h2 id="HTTP-Over-Websocket"><a href="#HTTP-Over-Websocket" class="headerlink" title="HTTP Over Websocket"></a>HTTP Over Websocket</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http+ws:&#x2F;&#x2F;:8080</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http+wss:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<p>使用Websocket (secure)作为传输类型。</p>
<h2 id="HTTP-Over-KCP"><a href="#HTTP-Over-KCP" class="headerlink" title="HTTP Over KCP"></a>HTTP Over KCP</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http+kcp:&#x2F;&#x2F;:8388</span><br></pre></td></tr></table></figure>
<p>使用KCP作为传输类型。</p>
<h1 id="HTTP2"><a href="#HTTP2" class="headerlink" title="HTTP2"></a>HTTP2</h1><p>在GOST中HTTP2有两种模式：代理模式和隧道模式。</p>
<h2 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h2><p>在代理模式中，HTTP2被用作协议类型，传输类型必须为空。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http2:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<p>443端口就是一个标准的HTTP2代理服务。</p>
<p>代理模式下仅支持使用TLS加密的HTTP2协议，不支持明文HTTP2传输。</p>
<h2 id="隧道模式"><a href="#隧道模式" class="headerlink" title="隧道模式"></a>隧道模式</h2><p>在隧道模式中，HTTP2被用作传输类型：h2, h2c。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L socks5+h2:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L http+h2c:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<p>隧道模式下支持加密(h2)和明文(h2c)两种模式。</p>
<p>参数说明<br>path - (2.9+) 可选，指定HTTP请求URI。</p>
<h1 id="探测防御"><a href="#探测防御" class="headerlink" title="探测防御"></a>探测防御</h1><p>GOST在2.7版本中增加了对HTTP/HTTPS/HTTP2代理的探测防御功能。当代理服务收到非法请求时，会按照探测防御策略返回对应的响应内容。</p>
<blockquote>
<p>只有当代理服务开启了用户认证，探测防御功能才有效。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;http2:&#x2F;&#x2F;admin:123456@:443?probe_resist&#x3D;code:400&amp;knock&#x3D;www.example.com&quot;</span><br></pre></td></tr></table></figure>
<h2 id="probe-resist"><a href="#probe-resist" class="headerlink" title="probe_resist"></a>probe_resist</h2><p>代理服务通过probe_resist参数来指定防御策略。参数值的格式为：type:value。</p>
<p>type可选值有:</p>
<p>code - 对应value为HTTP响应码，代理服务器会回复客户端指定的响应码。例如：probe_resist=code:404</p>
<p>web - 对应的value为URL，代理服务器会使用HTTP GET方式访问此URL，并将响应返回给客户端。例如: probe_resist=web:example.com/page.html</p>
<p>host - 对应的value为主机地址，代理服务器会将客户端请求转发给设置的主机地址，并将主机的响应返回给客户端，代理服务器在这里相当于端口转发服务。例如：probe_resist=host:example.com:8080</p>
<p>file - 对应的value为本地文件路径，代理服务器会回复客户端200响应码，并将指定的文件内容作为Body发送给客户端。例如：probe_resist=file:/path/to/file.txt</p>
<h2 id="knock（2-8"><a href="#knock（2-8" class="headerlink" title="knock（2.8+)"></a>knock（2.8+)</h2><p>开启了探测防御功能后，当认证失败时服务器默认不会响应407 Proxy Authentication Required，但某些情况下客户端需要服务器告知代理是否需要认证(例如Chrome中的SwitchyOmega插件)。通过knock参数设置一个私有地址，只有访问此地址时服务器才会发送407响应。</p>
<p>此功能可应用于HTTP，HTTPS和HTTP/2代理：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;http:&#x2F;&#x2F;admin:123456@:8080?probe_resist&#x3D;code:403</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;https:&#x2F;&#x2F;admin:123456@:443?probe_resist&#x3D;host:www.example.com:8080</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;http2:&#x2F;&#x2F;admin:123456@:443?probe_resist&#x3D;file:&#x2F;send&#x2F;to&#x2F;client&#x2F;file.txt</span><br></pre></td></tr></table></figure>
<h1 id="SCOKS"><a href="#SCOKS" class="headerlink" title="SCOKS"></a>SCOKS</h1><p>SOCKS是GOST支持的协议类型(Protocol)，SOCKS协议有三个版本: SOCKS4, SOCKS4A和SOCKS5。</p>
<h2 id="SOCKS4"><a href="#SOCKS4" class="headerlink" title="SOCKS4"></a>SOCKS4</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L socks4:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<p>标准的SOCKS4代理服务，同时兼容SOCKS4A协议。</p>
<h2 id="SOCKS4A"><a href="#SOCKS4A" class="headerlink" title="SOCKS4A"></a>SOCKS4A</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L socks4a:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<p>标准的SOCKS4A代理服务。</p>
<blockquote>
<p>SOCKS4(A)当前仅支持CONNECT方法，不支持BIND方法。</p>
</blockquote>
<h2 id="SOCKS5"><a href="#SOCKS5" class="headerlink" title="SOCKS5"></a>SOCKS5</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L socks5:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<h2 id="SOCKS5协商加密"><a href="#SOCKS5协商加密" class="headerlink" title="SOCKS5协商加密"></a>SOCKS5协商加密</h2><p>GOST支持标准SOCKS5协议的no-auth(0x00)和user-pass(0x02)方法，并在此基础上扩展了两个：tls(0x80)和tls-auth(0x82)，用于数据加密。</p>
<h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;socks5:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;socks5:&#x2F;&#x2F;server_ip:1080?notls&#x3D;true</span><br></pre></td></tr></table></figure>
<p>如果两端都是GOST(如上)则数据传输会被加密(协商使用tls或tls-auth方法)，否则使用标准SOCKS5进行通讯(no-auth或user/pass方法)。</p>
<p>notls - (2.9.1+) 通过此参数可以禁用协商加密，默认值：false。</p>
<h2 id="SOCKS5-UDP-Relay"><a href="#SOCKS5-UDP-Relay" class="headerlink" title="SOCKS5 UDP Relay"></a>SOCKS5 UDP Relay</h2><p>GOST中SOCKS5同时也支持UDP Relay，并支持TCP-over-UDP特性。</p>
<p>不设置转发代理</p>
<p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/udp01.png"></p>
<p>GOST做为标准SOCKS5代理处理UDP数据。</p>
<p>设置转发代理</p>
<p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/udp02.png"></p>
<p>设置多个转发代理(代理链)</p>
<p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/udp03.png"></p>
<p>当设置转发代理时，GOST会使用UDP-over-TCP方式转发UDP数据。proxy1 - proxyN可以为任意类型代理。</p>
<blockquote>
<p>如果要转发SOCKS5的BIND和UDP请求，代理链的末端(最后一个-F参数)必须是GOST SOCKS5类型代理。<br>SOCKS协议也可以与各种传输类型(Transport)组合使用</p>
</blockquote>
<h2 id="SOCKS5-Over-TLS"><a href="#SOCKS5-Over-TLS" class="headerlink" title="SOCKS5 Over TLS"></a>SOCKS5 Over TLS</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L socks5+tls:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<p>使用TLS加密的SOCKS5代理服务。</p>
<h2 id="SOCKS5-Over-QUIC"><a href="#SOCKS5-Over-QUIC" class="headerlink" title="SOCKS5 Over QUIC"></a>SOCKS5 Over QUIC</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L socks5+quic:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<h1 id="Shadowsocks"><a href="#Shadowsocks" class="headerlink" title="Shadowsocks"></a>Shadowsocks</h1><p>Shadowsocks是GOST支持的一种协议类型(Protocol)。</p>
<p>GOST对shadowsocks的支持是基于<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-go">shadowsocks/shadowsocks-go</a>库。</p>
<h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><blockquote>
<p>从2.10.1+开始加密变为可选。</p>
</blockquote>
<h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><h3 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h3><p>nodelay - true/false (默认值为false)。默认情况下ss协议会等待客户端的请求数据，当收到请求数据后会把协议头部信息与请求数据一起发给服务端。当此参数设为true后，协议头部信息会立即发给服务端，不再等待客户端的请求。</p>
<h3 id="服务端-1"><a href="#服务端-1" class="headerlink" title="服务端"></a>服务端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;ss:&#x2F;&#x2F;chacha20:password@:8338</span><br></pre></td></tr></table></figure>
<h3 id="客户端-1"><a href="#客户端-1" class="headerlink" title="客户端"></a>客户端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;ss:&#x2F;&#x2F;chacha20:password@server_ip:8338?nodelay&#x3D;true</span><br></pre></td></tr></table></figure>
<h2 id="AEAD加密"><a href="#AEAD加密" class="headerlink" title="AEAD加密"></a>AEAD加密</h2><blockquote>
<p>2.10.1+后，ss2功能已经合并到ss中，可以直接在ss中使用AEAD加密，ss2已废弃。<br>在2.8版本中，GOST基于shadowsocks/go-shadowsocks2增加了对AEAD加密的支持。</p>
</blockquote>
<h3 id="服务端-2"><a href="#服务端-2" class="headerlink" title="服务端"></a>服务端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;ss2:&#x2F;&#x2F;AEAD_CHACHA20_POLY1305:password@:8338</span><br></pre></td></tr></table></figure>
<h3 id="客户端-2"><a href="#客户端-2" class="headerlink" title="客户端"></a>客户端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;ss2:&#x2F;&#x2F;AEAD_CHACHA20_POLY1305:password@server_ip:8338</span><br></pre></td></tr></table></figure>
<h2 id="组合传输层"><a href="#组合传输层" class="headerlink" title="组合传输层"></a>组合传输层</h2><p>Shadowsocks协议可以与各种传输类型(Transport)组合使用</p>
<h3 id="Shadowsocks-Over-TLS"><a href="#Shadowsocks-Over-TLS" class="headerlink" title="Shadowsocks Over TLS"></a>Shadowsocks Over TLS</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L ss+tls:&#x2F;&#x2F;chacha20:123456@:8338</span><br></pre></td></tr></table></figure>
<h3 id="Shadowsocks-Over-KCP"><a href="#Shadowsocks-Over-KCP" class="headerlink" title="Shadowsocks Over KCP"></a>Shadowsocks Over KCP</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L ss+kcp:&#x2F;&#x2F;chacha20:123456@:8338</span><br></pre></td></tr></table></figure>
<h2 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h2><h3 id="服务端-3"><a href="#服务端-3" class="headerlink" title="服务端"></a>服务端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;ssu:&#x2F;&#x2F;method:password@:8338?ttl&#x3D;60s</span><br></pre></td></tr></table></figure>
<p>ttl - (2.10+) 传输通道超时时间，默认为60s。</p>
<h2 id="2-10-后的变化"><a href="#2-10-后的变化" class="headerlink" title="2.10+后的变化"></a>2.10+后的变化</h2><h2 id="客户端支持"><a href="#客户端支持" class="headerlink" title="客户端支持"></a>客户端支持</h2><p>ssu可以用在转发链中用来转发UDP数据：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L udp:&#x2F;&#x2F;:5353&#x2F;8.8.8.8:53 -F&#x3D;ssu:&#x2F;&#x2F;method:password@:8338</span><br></pre></td></tr></table></figure>
<h2 id="加密方法"><a href="#加密方法" class="headerlink" title="加密方法"></a>加密方法</h2><p>加密变为可选。</p>
<p>基于<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-go">shadowsocks/go-shadowsocks2</a>增加了对AEAD加密的支持，且兼容老版本中的加密方式。</p>
<p>当设置了加密，会优先使用(shadowsocks/shadowsocks-go)库，若加密方法不支持，则切换到(shadowsocks/go-shadowsocks2)库。</p>
<h2 id="组合传输层-1"><a href="#组合传输层-1" class="headerlink" title="组合传输层"></a>组合传输层</h2><p>ssu在2.10版本中，变成了一种协议类型，可以与各种传输类型组合使用：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L ssu+kcp:&#x2F;&#x2F;:8338</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L ssu+wss:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<p>默认情况下ssu等同于ssu+udp，传输层为原始UDP协议。这种情况下，GOST会使用shadowsocks本身的UDP relay协议进行数据转发。</p>
<p>如果指定了其他传输类型，则会使用SOCKS5的UDP relay协议进行数据转发。</p>
<blockquote>
<p>ssu仅能用于转发UDP数据，转发TCP数据的行为未定义。<br>当用在转发链中时，ssu必须为转发链的最后一个节点。<br>当ssu+udp用于转发链中时，转发链中不能存在其他节点。</p>
</blockquote>
<h1 id="SNI"><a href="#SNI" class="headerlink" title="SNI"></a>SNI</h1><p>SNI是GOST支持的一种协议类型(Protocol)。</p>
<h2 id="使用说明-1"><a href="#使用说明-1" class="headerlink" title="使用说明"></a>使用说明</h2><h2 id="服务端-4"><a href="#服务端-4" class="headerlink" title="服务端"></a>服务端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L sni:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<h2 id="客户端-3"><a href="#客户端-3" class="headerlink" title="客户端"></a>客户端</h2><p>可以通过配置hosts直接使用，或使用GOST进行转发:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F sni:&#x2F;&#x2F;server_ip:443</span><br></pre></td></tr></table></figure>
<h2 id="Host混淆"><a href="#Host混淆" class="headerlink" title="Host混淆"></a>Host混淆</h2><p>在GOST中SNI客户端可以通过host参数来指定Host别名：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F sni:&#x2F;&#x2F;server_ip:443?host&#x3D;example.com</span><br></pre></td></tr></table></figure>
<p>SNI客户端会将TLS握手或HTTP请求头中的Host替换为host参数指定的内容。</p>
<p>SNI协议可以与各种传输类型(Transport)组合使用</p>
<h2 id="SNI-Over-TLS"><a href="#SNI-Over-TLS" class="headerlink" title="SNI Over TLS"></a>SNI Over TLS</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L sni+tls:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<h2 id="SNI-Over-Websocket"><a href="#SNI-Over-Websocket" class="headerlink" title="SNI Over Websocket"></a>SNI Over Websocket</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L sni+ws:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<h1 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h1><p>TLS是GOST支持的一种传输类型(Transport)。</p>
<h2 id="使用说明-2"><a href="#使用说明-2" class="headerlink" title="使用说明"></a>使用说明</h2><h2 id="标准TLS"><a href="#标准TLS" class="headerlink" title="标准TLS"></a>标准TLS</h2><h3 id="服务端-5"><a href="#服务端-5" class="headerlink" title="服务端"></a>服务端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tls:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<h3 id="客户端-4"><a href="#客户端-4" class="headerlink" title="客户端"></a>客户端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F tls:&#x2F;&#x2F;server_ip:443</span><br></pre></td></tr></table></figure>
<h2 id="多路复用TLS"><a href="#多路复用TLS" class="headerlink" title="多路复用TLS"></a>多路复用TLS</h2><p>GOST在TLS基础之上扩展出具有多路复用(Multiplex)特性的TLS传输类型(mtls)。</p>
<h3 id="服务端-6"><a href="#服务端-6" class="headerlink" title="服务端"></a>服务端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L mtls:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<h3 id="客户端-5"><a href="#客户端-5" class="headerlink" title="客户端"></a>客户端</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F mtls:&#x2F;&#x2F;server_ip:443</span><br></pre></td></tr></table></figure>
<h2 id="TLS证书"><a href="#TLS证书" class="headerlink" title="TLS证书"></a>TLS证书</h2><p>GOST内置了TLS证书，如果需要使用自定义TLS证书，有两种方法：</p>
<p>在GOST运行目录放置cert.pem(公钥)和key.pem(私钥)两个文件即可，GOST会自动加载运行目录下的cert.pem和key.pem文件。</p>
<p>使用key和cert参数指定证书文件路径：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;tls:&#x2F;&#x2F;:443?cert&#x3D;&#x2F;path&#x2F;to&#x2F;my&#x2F;cert&#x2F;file&amp;key&#x3D;&#x2F;path&#x2F;to&#x2F;my&#x2F;key&#x2F;file&quot;</span><br></pre></td></tr></table></figure>
<h2 id="证书校验"><a href="#证书校验" class="headerlink" title="证书校验"></a>证书校验</h2><p>对于客户端可以通过secure参数开启服务器证书和域名校验，默认不校验证书:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;&quot;tls:&#x2F;&#x2F;server_domain_name:443?secure&#x3D;true&quot;</span><br></pre></td></tr></table></figure>
<p>当需要校验证书时，节点配置中的server_domain_name部分必须填写服务器的域名。</p>
<h2 id="证书锁定"><a href="#证书锁定" class="headerlink" title="证书锁定"></a>证书锁定</h2><p>对于客户端可以通过ca参数指定CA证书进行证书锁定(Certificate Pinning):</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;&quot;tls:&#x2F;&#x2F;:443?ca&#x3D;ca.pem&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上参数可以用于所有支持TLS的服务，例如HTTP2, QUIC, WSS, SSH, SOCKS5。</p>
</blockquote>
<h2 id="双向证书校验-2-11-1"><a href="#双向证书校验-2-11-1" class="headerlink" title="双向证书校验(2.11.1+)"></a>双向证书校验(2.11.1+)</h2><p>服务端可以通过ca参数指定CA证书来对客户端证书进行强制校验：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;tls:&#x2F;&#x2F;:443?cert&#x3D;certfile&amp;key&#x3D;keyfile&amp;ca&#x3D;cafile&quot;</span><br></pre></td></tr></table></figure>
<p>此时客户端必须提供自己的证书：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;&quot;tls:&#x2F;&#x2F;server_ip:443?cert&#x3D;certfile&amp;key&#x3D;keyfile&quot;</span><br></pre></td></tr></table></figure>
<h1 id="Websocket"><a href="#Websocket" class="headerlink" title="Websocket"></a>Websocket</h1><p>Websocket是GOST支持的传输类型(Transport)。</p>
<h2 id="使用说明-3"><a href="#使用说明-3" class="headerlink" title="使用说明"></a>使用说明</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L &quot;ws:&#x2F;&#x2F;:8080?path&#x3D;&#x2F;ws&amp;rbuf&#x3D;4096&amp;wbuf&#x3D;4096&amp;compression&#x3D;false&quot;</span><br></pre></td></tr></table></figure>
<h2 id="参数说明-1"><a href="#参数说明-1" class="headerlink" title="参数说明"></a>参数说明</h2><p>path - 设置请求URI，默认值为/ws</p>
<p>rbuf - 接收缓冲区大小，默认值：4096</p>
<p>wbuf - 发送缓冲区大小，默认值：4096</p>
<p>compression - 是否使用压缩，默认值：false</p>
<p>GOST中的Websocket有四种类型：</p>
<h2 id="标准Websocket"><a href="#标准Websocket" class="headerlink" title="标准Websocket"></a>标准Websocket</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L ws:&#x2F;&#x2F;:8080</span><br></pre></td></tr></table></figure>
<p>未加密的websocket隧道。</p>
<h2 id="Multiplex-Websocket"><a href="#Multiplex-Websocket" class="headerlink" title="Multiplex Websocket"></a>Multiplex Websocket</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L mws:&#x2F;&#x2F;:8080</span><br></pre></td></tr></table></figure>
<p>具有多路复用特性的未加密websocket隧道。</p>
<h2 id="Websocket-Secure"><a href="#Websocket-Secure" class="headerlink" title="Websocket Secure"></a>Websocket Secure</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L wss:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<p>使用TLS加密的Websocket隧道。</p>
<h2 id="Multiplex-Websocket-Secure"><a href="#Multiplex-Websocket-Secure" class="headerlink" title="Multiplex Websocket Secure"></a>Multiplex Websocket Secure</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L mwss:&#x2F;&#x2F;:443</span><br></pre></td></tr></table></figure>
<p>具有多路复用特性并使用TLS加密的Websocket隧道。</p>
<h1 id="KCP"><a href="#KCP" class="headerlink" title="KCP"></a>KCP</h1><p>KCP是GOST支持的一种传输类型(Transport)。</p>
<p>GOST对KCP的支持是基于xtaci/kcp-go和xtaci/kcptun库。</p>
<h2 id="使用说明-4"><a href="#使用说明-4" class="headerlink" title="使用说明"></a>使用说明</h2><h2 id="服务端-7"><a href="#服务端-7" class="headerlink" title="服务端"></a>服务端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;kcp:&#x2F;&#x2F;:8388</span><br></pre></td></tr></table></figure>
<h2 id="客户端-6"><a href="#客户端-6" class="headerlink" title="客户端"></a>客户端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;kcp:&#x2F;&#x2F;server_ip:8388</span><br></pre></td></tr></table></figure>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>GOST中内置了一套默认的KCP配置项，默认值与xtaci/kcptun中的一致。可以通过参数c指定外部配置文件：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;kcp:&#x2F;&#x2F;:8388?c&#x3D;&#x2F;path&#x2F;to&#x2F;conf&#x2F;file</span><br></pre></td></tr></table></figure>
<p>配置文件格式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;key&quot;: &quot;it&#39;s a secrect&quot;,</span><br><span class="line">    &quot;crypt&quot;: &quot;aes&quot;,</span><br><span class="line">    &quot;mode&quot;: &quot;fast&quot;,</span><br><span class="line">    &quot;mtu&quot; : 1350,</span><br><span class="line">    &quot;sndwnd&quot;: 1024,</span><br><span class="line">    &quot;rcvwnd&quot;: 1024,</span><br><span class="line">    &quot;datashard&quot;: 10,</span><br><span class="line">    &quot;parityshard&quot;: 3,</span><br><span class="line">    &quot;dscp&quot;: 0,</span><br><span class="line">    &quot;nocomp&quot;: false,</span><br><span class="line">    &quot;acknodelay&quot;: false,</span><br><span class="line">    &quot;nodelay&quot;: 0,</span><br><span class="line">    &quot;interval&quot;: 40,</span><br><span class="line">    &quot;resend&quot;: 0,</span><br><span class="line">    &quot;nc&quot;: 0,</span><br><span class="line">    &quot;sockbuf&quot;: 4194304,</span><br><span class="line">    &quot;keepalive&quot;: 10,</span><br><span class="line">    &quot;snmplog&quot;: &quot;&quot;,</span><br><span class="line">    &quot;snmpperiod&quot;: 60,</span><br><span class="line">    &quot;tcp&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置文件中的参数说明请参考<a target="_blank" rel="noopener" href="https://github.com/xtaci/kcptun#usage">kcptun</a>。</p>
<blockquote>
<p>若要在代理链中使用KCP节点，则此代理链中只能有一个KCP节点，且此节点只能作为代理链的第一个节点。</p>
</blockquote>
<h2 id="Fake-TCP-2-9-1"><a href="#Fake-TCP-2-9-1" class="headerlink" title="Fake TCP (2.9.1+)"></a>Fake TCP (2.9.1+)</h2><p>可以通过tcp参数或配置文件中的tcp项开启伪TCP模式。</p>
<blockquote>
<p>此功能仅适用于Linux。</p>
</blockquote>
<h2 id="服务端-8"><a href="#服务端-8" class="headerlink" title="服务端"></a>服务端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;kcp:&#x2F;&#x2F;:8388?tcp&#x3D;true</span><br></pre></td></tr></table></figure>
<h2 id="客户端-7"><a href="#客户端-7" class="headerlink" title="客户端"></a>客户端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;kcp:&#x2F;&#x2F;server_ip:8388?tcp&#x3D;true</span><br></pre></td></tr></table></figure>
<h1 id="QUIC"><a href="#QUIC" class="headerlink" title="QUIC"></a>QUIC</h1><p>QUIC是GOST支持的一种传输类型(Transport)。GOST对QUIC的支持是基于<a target="_blank" rel="noopener" href="https://github.com/lucas-clemente/quic-go">lucas-clemente/quic-go</a>库。</p>
<h2 id="使用说明-5"><a href="#使用说明-5" class="headerlink" title="使用说明"></a>使用说明</h2><h2 id="服务端-9"><a href="#服务端-9" class="headerlink" title="服务端"></a>服务端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;quic:&#x2F;&#x2F;:6121</span><br></pre></td></tr></table></figure>
<h2 id="客户端-8"><a href="#客户端-8" class="headerlink" title="客户端"></a>客户端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;quic:&#x2F;&#x2F;server_ip:6121</span><br></pre></td></tr></table></figure>
<h2 id="心跳"><a href="#心跳" class="headerlink" title="心跳"></a>心跳</h2><p>客户端可以通过keepalive参数开启心跳检测</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;quic:&#x2F;&#x2F;server_ip:6121?keepalive&#x3D;true</span><br></pre></td></tr></table></figure>
<blockquote>
<p>若要在代理链中使用QUIC节点，则此代理链中只能有一个QUIC节点，且此节点只能作为代理链的第一个节点。</p>
</blockquote>
<h1 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h1><p>SSH是GOST支持的一种传输类型(Transport)。</p>
<h2 id="使用说明-6"><a href="#使用说明-6" class="headerlink" title="使用说明"></a>使用说明</h2><h2 id="服务端-10"><a href="#服务端-10" class="headerlink" title="服务端"></a>服务端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;ssh:&#x2F;&#x2F;:2222</span><br></pre></td></tr></table></figure>
<h2 id="客户端-9"><a href="#客户端-9" class="headerlink" title="客户端"></a>客户端</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;ssh:&#x2F;&#x2F;server_ip:2222?ping&#x3D;60</span><br></pre></td></tr></table></figure>
<p>客户端可以通过ping参数设置心跳包发送周期，单位为秒。默认不发送心跳包。</p>
<h2 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h2><p>GOST中的SSH也支持标准SSH协议的端口转发功能，具体使用方法请参考端口转发</p>
<h2 id="PubKey认证-2-11"><a href="#PubKey认证-2-11" class="headerlink" title="PubKey认证 (2.11+)"></a>PubKey认证 (2.11+)</h2><p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;ssh:&#x2F;&#x2F;:2222?ssh_authorized_keys&#x3D;&#x2F;path&#x2F;to&#x2F;authorized_keys&quot;</span><br></pre></td></tr></table></figure>
<p>ssh_authorized_keys - 客户端公钥列表文件</p>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F&#x3D;ssh:&#x2F;&#x2F;server_ip:2222?ssh_key&#x3D;&#x2F;path&#x2F;to&#x2F;id_rsa&quot;</span><br></pre></td></tr></table></figure>
<p>ssh_key - 客户端私钥文件</p>
<h1 id="Simple-obfs"><a href="#Simple-obfs" class="headerlink" title="Simple-obfs"></a>Simple-obfs</h1><p>Simple-obfs是GOST支持的一种传输类型(Transport)。</p>
<p>Simple-obfs兼容<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/simple-obfs">shadowsocks/simple-obfs</a>和Android上的<a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.github.shadowsocks.plugin.obfs_local">Simple Obfuscation</a>插件。</p>
<h2 id="使用说明-7"><a href="#使用说明-7" class="headerlink" title="使用说明"></a>使用说明</h2><h2 id="obfs-http"><a href="#obfs-http" class="headerlink" title="obfs-http"></a>obfs-http</h2><p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;ss+ohttp:&#x2F;&#x2F;chacha20:123456@:8338</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;ss+ohttp:&#x2F;&#x2F;chacha20:123456@server_ip:8338?host&#x3D;bing.com</span><br></pre></td></tr></table></figure>
<p>客户端可以通过host参数自定义请求Host。</p>
<h2 id="obfs-tls-2-11"><a href="#obfs-tls-2-11" class="headerlink" title="obfs-tls (2.11+)"></a>obfs-tls (2.11+)</h2><p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;ss+otls:&#x2F;&#x2F;chacha20:123456@:8338</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;ss+otls:&#x2F;&#x2F;chacha20:123456@server_ip:8338?host&#x3D;bing.com</span><br></pre></td></tr></table></figure>
<p>客户端可以通过host参数自定义请求Host。</p>
<blockquote>
<p>obfs-tls目前仅支持<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-go">shadowsocks/shadowsocks-go</a>库所支持的加密方式，不支持AEAD加密。</p>
</blockquote>
<h1 id="Obfs4"><a href="#Obfs4" class="headerlink" title="Obfs4"></a>Obfs4</h1><p>Obfs4是GOST支持的一种传输类型(Transport)。</p>
<p>首先要运行服务端，生成客户端访问的URL：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L ss+obfs4:&#x2F;&#x2F;:18080</span><br></pre></td></tr></table></figure>
<p>当正常启动后，会在控制台显示URL</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ss+obfs4:&#x2F;&#x2F;:18080&#x2F;?cert&#x3D;06ss%2FlcDWVkTZLXLcRkH8tozyP0aUXmOm%2BuT5KtbkEP%2BTnCqNumFx9p218Vy0WityAM0Kg&amp;iat-mode&#x3D;0</span><br></pre></td></tr></table></figure>
<p>然后再使用生成的参数启动客户端：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F ss+obfs4:&#x2F;&#x2F;server_ip:18080&#x2F;?cert&#x3D;06ss%2FlcDWVkTZLXLcRkH8tozyP0aUXmOm%2BuT5KtbkEP%2BTnCqNumFx9p218Vy0WityAM0Kg&amp;iat-mode&#x3D;0</span><br></pre></td></tr></table></figure>
<p>这里生成的URL不包含IP，所以如果客户端与服务端不是同一台主机，就要指定服务端的IP。</p>
<h1 id="透明代理"><a href="#透明代理" class="headerlink" title="透明代理"></a>透明代理</h1><p>GOST在2.3版本中增加了对TCP透明代理的支持，在2.10版本中增加了对UDP透明代理的支持。</p>
<blockquote>
<p>透明代理仅支持Linux系统。</p>
</blockquote>
<h2 id="TCP-1"><a href="#TCP-1" class="headerlink" title="TCP"></a>TCP</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L red:&#x2F;&#x2F;:12345 -F 192.168.1.1:1080</span><br></pre></td></tr></table></figure>
<h2 id="本地全局TCP代理："><a href="#本地全局TCP代理：" class="headerlink" title="本地全局TCP代理："></a>本地全局TCP代理：</h2><p>设置iptables：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">iptables -t nat -A OUTPUT -p tcp --match multiport ! --dports 12345,1080 -j DNAT --to-destination 127.0.0.1:12345</span><br></pre></td></tr></table></figure>
<h2 id="UDP-2-10"><a href="#UDP-2-10" class="headerlink" title="UDP (2.10+)"></a>UDP (2.10+)</h2><p>UDP透明代理是基于iptables的tproxy模块实现的。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L redu:&#x2F;&#x2F;:12345?ttl&#x3D;60s -F ssu:&#x2F;&#x2F;1.2.3.4:1080</span><br></pre></td></tr></table></figure>
<p>ttl - 传输通道超时时间，默认为60s。</p>
<h2 id="本地全局UDP代理"><a href="#本地全局UDP代理" class="headerlink" title="本地全局UDP代理"></a>本地全局UDP代理</h2><h3 id="设置iptables规则"><a href="#设置iptables规则" class="headerlink" title="设置iptables规则"></a>设置iptables规则</h3><blockquote>
<p>规则中的192.168.0.0/16为本机所在网络，1.2.3.4/32为转发服务端地址，请根据实际情况进行修改。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">iptables -t mangle -N GOST</span><br><span class="line">iptables -t mangle -N GOST_LOCAL</span><br><span class="line"></span><br><span class="line">iptables -t mangle -A GOST -d 255.255.255.255&#x2F;32 -j RETURN</span><br><span class="line">iptables -t mangle -A GOST -d 127.0.0.0&#x2F;8 -p udp -j RETURN</span><br><span class="line">iptables -t mangle -A GOST -d 192.168.0.0&#x2F;16 -p udp -j RETURN</span><br><span class="line">iptables -t mangle -A GOST -p udp -j TPROXY --on-port 12345 --on-ip 0.0.0.0 --tproxy-mark 1</span><br><span class="line"></span><br><span class="line">iptables -t mangle -A GOST_LOCAL -d 255.255.255.255&#x2F;32 -j RETURN</span><br><span class="line">iptables -t mangle -A GOST_LOCAL -d 192.168.0.0&#x2F;16 -p udp -j RETURN</span><br><span class="line">iptables -t mangle -A GOST_LOCAL -d 1.2.3.4&#x2F;32 -p udp -j RETURN</span><br><span class="line">iptables -t mangle -A GOST_LOCAL -p udp -j MARK --set-mark 1</span><br><span class="line"></span><br><span class="line">iptables -t mangle -A PREROUTING -j GOST</span><br><span class="line">iptables -t mangle -A OUTPUT -j GOST_LOCAL</span><br></pre></td></tr></table></figure>
<p>设置路由表</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ip rule add fwmark 1 table 100</span><br><span class="line">ip route add local 0.0.0.0&#x2F;0 dev lo table 100</span><br></pre></td></tr></table></figure>

<h1 id="端口转发-1"><a href="#端口转发-1" class="headerlink" title="端口转发"></a>端口转发</h1><p>GOST从2.1版本开始增加了对端口转发的支持。</p>
<h2 id="使用说明-8"><a href="#使用说明-8" class="headerlink" title="使用说明"></a>使用说明</h2><p>端口转发服务节点的配置与普通的代理节点有所不同:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scheme:&#x2F;&#x2F;[bind_address]:port&#x2F;[host]:hostport[,[host]:hostport]?ip&#x3D;[host]:hostport][,[host]:hostport]]</span><br></pre></td></tr></table></figure>
<p>scheme - 端口转发模式, 本地端口转发: tcp, udp; 远程端口转发: rtcp, rudp; 转发隧道: tls, kcp等传输类型。</p>
<p>[bind_address]:port - 本地/远程绑定地址。</p>
<p>[host]:hostport[,[host]:hostport] - (可选, 2.6+) 目标访问地址，支持以逗号分割的多地址形式。</p>
<h2 id="参数说明-2"><a href="#参数说明-2" class="headerlink" title="参数说明"></a>参数说明</h2><p>ip - (可选, 2.8+) 也可以通过此参数来指定目标地址。</p>
<p>strategy - 指定节点选择策略，round - 轮询，random - 随机, fifo - 自上而下。默认值为round。</p>
<p>max_fails - (2.8.1+) 指定节点连接的最大失败次数，当与一个节点建立连接失败次数超过此设定值时，此节点会被标记为死亡节点(Dead)，死亡节点不会被选择使用。默认值为1。</p>
<p>fail_timeout - (2.8.1+) 指定死亡节点的超时时间，当一个节点被标记为死亡节点后，在此设定的时间间隔内不会被选择使用，超过此设定时间间隔后，会再次参与节点选择。默认为30秒。</p>
<h2 id="TCP本地端口转发"><a href="#TCP本地端口转发" class="headerlink" title="TCP本地端口转发"></a>TCP本地端口转发</h2><p>将本地的TCP端口A映射到指定的目标TCP端口B，所有到端口A的数据会被转发到端口B。此功能类似于SSH的本地端口转发功能。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;tcp:&#x2F;&#x2F;:2222&#x2F;192.168.1.1:22 [-F&#x3D;..]</span><br></pre></td></tr></table></figure>
<p>将本地TCP端口2222上的数据(通过代理链)转发到192.168.1.1:22上。</p>
<p>当代理链末端(最后一个-F参数)为forward+ssh类型时，GOST会直接使用SSH的本地端口转发功能:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;tcp:&#x2F;&#x2F;:2222&#x2F;192.168.1.1:22 -F forward+ssh:&#x2F;&#x2F;:2222</span><br></pre></td></tr></table></figure>
<p>服务端可以是标准的SSH程序，也可以是GOST的SSH转发模式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L forward+ssh:&#x2F;&#x2F;:2222</span><br></pre></td></tr></table></figure>
<p>scheme必须是forward+ssh。</p>
<h2 id="TCP远程端口转发"><a href="#TCP远程端口转发" class="headerlink" title="TCP远程端口转发"></a>TCP远程端口转发</h2><p>将目标TCP端口B映射到本地TCP端口A，所有到端口B上的数据会被转发到端口A。此功能类似于SSH的远程端口转发功能。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;rtcp:&#x2F;&#x2F;:2222&#x2F;192.168.1.1:22 [-F&#x3D;... -F&#x3D;socks5:&#x2F;&#x2F;172.24.10.1:1080]</span><br></pre></td></tr></table></figure>
<p>将172.24.10.1:2222上的数据(通过代理链)转发到192.168.1.1:22上。</p>
<h2 id="SOCKS5多路复用模式"><a href="#SOCKS5多路复用模式" class="headerlink" title="SOCKS5多路复用模式"></a>SOCKS5多路复用模式</h2><p>在2.5版本中，SOCKS5的BIND方法增加了对多路复用的支持，远程端口转发可以利用这个特性提高传输效率。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L rtcp:&#x2F;&#x2F;:8080&#x2F;192.168.1.1:80 -F socks5:&#x2F;&#x2F;:1080?mbind&#x3D;true</span><br></pre></td></tr></table></figure>
<p>客户端通过mbind=true参数开启SOCKS5的BIND多路复用模式。</p>
<h2 id="SSH端口转发模式"><a href="#SSH端口转发模式" class="headerlink" title="SSH端口转发模式"></a>SSH端口转发模式</h2><p>当代理链末端(最后一个-F参数)为forward+ssh类型时，GOST会直接使用SSH的远程端口转发功能:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;rtcp:&#x2F;&#x2F;:2222&#x2F;192.168.1.1:22 -F forward+ssh:&#x2F;&#x2F;:2222</span><br></pre></td></tr></table></figure>
<p>服务端可以是标准的SSH程序，也可以是GOST的SSH转发模式：</p>
<p>gost -L forward+ssh://:2222<br>scheme必须是forward+ssh。</p>
<h2 id="UDP本地端口转发"><a href="#UDP本地端口转发" class="headerlink" title="UDP本地端口转发"></a>UDP本地端口转发</h2><p>将本地的UDP端口A映射到指定的目标UDP端口B，所有到端口A的数据会被转发到端口B。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;udp:&#x2F;&#x2F;:5353&#x2F;192.168.1.1:53?ttl&#x3D;60s [-F&#x3D;... -F&#x3D;socks5:&#x2F;&#x2F;172.24.10.1:1080]</span><br></pre></td></tr></table></figure>
<p>将本地UDP端口5353上的数据(通过代理链)转发到192.168.1.1:53上。</p>
<p>每一个不同的客户端(不同的端口)对应一条转发通道，每条转发通道都有超时时间，当超过此时间且在此时间段内无任何数据交互，则此通道将关闭。 可以通过ttl参数来设置超时时间，默认值为60秒。</p>
<h2 id="UDP远程端口转发"><a href="#UDP远程端口转发" class="headerlink" title="UDP远程端口转发"></a>UDP远程端口转发</h2><p>将目标UDP端口B映射到本地UDP端口A，所有到端口B上的数据会被转发到端口A。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;rudp:&#x2F;&#x2F;:5353&#x2F;192.168.1.1:53?ttl&#x3D;60s [-F&#x3D;... -F&#x3D;socks5:&#x2F;&#x2F;172.24.10.1:1080]</span><br></pre></td></tr></table></figure>
<p>将172.24.10.1:5353上的数据(通过代理链)转发到192.168.1.1:53上。</p>
<p>每一个不同的客户端(不同的端口)对应一条转发通道，每条转发通道都有超时时间，当超过此时间且在此时间段内无任何数据交互，则此通道将关闭。 可以通过ttl参数来设置超时时间，默认值为60秒。</p>
<blockquote>
<p>转发UDP数据时，如果有代理链，则代理链的末端(最后一个-F参数)协议必须是GOST socks5类型，传输层可以任意选择。</p>
</blockquote>
<p>2.10+后本地UDP端口转发也可以使用ssu进行转发。</p>
<h2 id="转发隧道"><a href="#转发隧道" class="headerlink" title="转发隧道"></a>转发隧道</h2><p>在2.5版本中TCP本地端口转发可以配合传输类型一起使用：</p>
<p>服务端:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tls:&#x2F;&#x2F;:443&#x2F;:1443 -L sni:&#x2F;&#x2F;:1443</span><br></pre></td></tr></table></figure>
<p>对应的scheme为传输类型，协议类型必须为空。</p>
<p>客户端:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F forward+tls:&#x2F;&#x2F;server_ip:443</span><br></pre></td></tr></table></figure>
<p>对应的scheme为forward+transport格式，其中协议类型必须为forward。</p>
<h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><p>加密</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tls:&#x2F;&#x2F;:443&#x2F;:8080 -L http:&#x2F;&#x2F;:8080</span><br></pre></td></tr></table></figure>
<p>将8080端口的HTTP代理服务转成443端口的HTTPS代理服务</p>
<p>加速</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L kcp:&#x2F;&#x2F;:8388&#x2F;:8338 -L ss:&#x2F;&#x2F;chacha20:123456@:8338</span><br></pre></td></tr></table></figure>
<p>将8338端口的shadowsocks代理服务转成使用KCP传输。</p>
<h1 id="Relay"><a href="#Relay" class="headerlink" title="Relay"></a>Relay</h1><p>Relay是GOST(2.11+)支持的一种协议类型(Protocol)。</p>
<blockquote>
<p>Relay协议本身不具备加密功能，如果需要对数据进行加密传输，可以配合加密隧道使用。</p>
</blockquote>
<h2 id="使用说明-9"><a href="#使用说明-9" class="headerlink" title="使用说明"></a>使用说明</h2><p>Relay协议同时具有代理和转发功能，可同时处理TCP和UDP的数据，并支持用户认证。</p>
<h2 id="参数说明-3"><a href="#参数说明-3" class="headerlink" title="参数说明"></a>参数说明</h2><p>nodelay - true/false (默认值为false)。默认情况下relay协议会等待客户端的请求数据，当收到请求数据后会把协议头部信息与请求数据一起发给服务端。当此参数设为true后，协议头部信息会立即发给服务端，不再等待客户端的请求。</p>
<h2 id="代理功能"><a href="#代理功能" class="headerlink" title="代理功能"></a>代理功能</h2><p>Relay协议可以像HTTP/SOCKS5一样用作代理协议。</p>
<p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L relay+tls:&#x2F;&#x2F;username:password@:12345</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080 -F relay+tls:&#x2F;&#x2F;username:password@:12345?nodelay&#x3D;false</span><br></pre></td></tr></table></figure>
<h2 id="转发功能"><a href="#转发功能" class="headerlink" title="转发功能"></a>转发功能</h2><p>Relay转发有两种模式，一种是配合端口转发使用，另一种是配合转发隧道使用。两种模式均可以同时转发TCP和UDP数据。</p>
<h3 id="端口转发-2"><a href="#端口转发-2" class="headerlink" title="端口转发"></a>端口转发</h3><p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L relay:&#x2F;&#x2F;:12345</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L udp:&#x2F;&#x2F;:1053&#x2F;:53 -L tcp:&#x2F;&#x2F;:1053&#x2F;:53 -F relay:&#x2F;&#x2F;:12345</span><br></pre></td></tr></table></figure>
<h3 id="转发隧道-1"><a href="#转发隧道-1" class="headerlink" title="转发隧道"></a>转发隧道</h3><p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L relay:&#x2F;&#x2F;:12345&#x2F;:53</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L udp:&#x2F;&#x2F;:1053 -L tcp:&#x2F;&#x2F;:1053 -F relay:&#x2F;&#x2F;:12345</span><br></pre></td></tr></table></figure>
<h1 id="权限控制"><a href="#权限控制" class="headerlink" title="权限控制"></a>权限控制</h1><p>服务端可以通过白名单whitelist参数和黑名单blacklist参数来控制客户端的请求是否允许被处理。 参数格式为: [actions]:[hosts]:[ports]</p>
<p>[actions]是一个由,分割的动作列表，可选值有: tcp(TCP转发), udp(UDP转发), rtcp(TCP远程转发), rudp(UDP远程转发), 或 *(所有动作)。</p>
<p>[hosts]是一个由,分割的Host列表，代表可以绑定到(rtcp,rudp)或转发到(tcp,udp)的目的主机，支持通配符(<em>.google.com)和</em>(所有主机)。</p>
<p>[ports]是一个由,分割的端口列表，代表可以绑定到(rtcp,rudp)或转发到(tcp,udp)的目的端口，可以是*(所有端口)。</p>
<p>多组权限可以通过+进行连接:</p>
<p>whitelist=rtcp,rudp:localhost,127.0.0.1:2222,8000-9000+udp:8.8.8.8,8.8.4.4:53(允许TCP/UDP远程端口转发绑定到localhost,127.0.0.1的2222端口和8000-9000端口范围，同时允许UDP转发到8.8.8.8:53和8.8.4.4:53)。</p>
<p>SSH远程端口转发只能绑定到127.0.0.1:8000</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;forward+ssh:&#x2F;&#x2F;localhost:8389?whitelist&#x3D;rtcp:127.0.0.1:8000</span><br></pre></td></tr></table></figure>
<p>SOCKS5的TCP/UDP远程端口转发只允许绑定到大于1000的端口</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;socks:&#x2F;&#x2F;localhost:8389?blacklist&#x3D;rtcp,rudp:*:0-1000</span><br></pre></td></tr></table></figure>
<p>SOCKS5的UDP转发只能转发到8.8.8.8:53</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;socks:&#x2F;&#x2F;localhost:8389?whitelist&#x3D;udp:8.8.8.8:53</span><br></pre></td></tr></table></figure>
<h1 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h1><blockquote>
<p>节点组<br>一个节点组由一个或多个节点组成，每个节点可以是任意类型。 GOST代理链的每一层级都是一个节点组。</p>
</blockquote>
<p>GOST在2.5版本中增加了对负载均衡的支持。负载均衡可以应用于代理链的所有层级节点。</p>
<p>负载均衡有两种，这里简单的称之为简单型和复杂型，两种类型可以组合使用。</p>
<h2 id="简单型"><a href="#简单型" class="headerlink" title="简单型"></a>简单型</h2><p>简单型是一种类似于DNS负载均衡的功能，可以为代理节点指定多个地址：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;&#39;http:&#x2F;&#x2F;localhost:8080?ip&#x3D;192.168.1.1,192.168.1.2:8081,192.168.1.3:8082&amp;strategy&#x3D;round&amp;max_fails&#x3D;1&amp;fail_timeout&#x3D;30s&#39; -F&#x3D;socks5:&#x2F;&#x2F;localhost:1080?ip&#x3D;172.20.1.1:1080,172.20.1.2:1081,172.20.1.3:1082</span><br></pre></td></tr></table></figure>
<h2 id="参数说明-4"><a href="#参数说明-4" class="headerlink" title="参数说明"></a>参数说明</h2><p>ip - 指定实际的代理服务地址(以逗号分割的列表)，地址格式可以是ip[:port]或hostname[:port]，若没有指定port则默认使用URL中的port。</p>
<p>strategy - (2.6+) 指定节点选择策略，round - 轮询，random - 随机, fifo - 自上而下。默认值为round。</p>
<p>max_fails - (2.8.1+) 指定节点连接的最大失败次数，当与一个节点建立连接失败次数超过此设定值时，此节点会被标记为死亡节点(Dead)，死亡节点不会被选择使用。默认值为1。</p>
<p>fail_timeout - (2.8.1+) 指定死亡节点的超时时间，当一个节点被标记为死亡节点后，在此设定的时间间隔内不会被选择使用，超过此设定时间间隔后，会再次参与节点选择。默认为30秒。</p>
<blockquote>
<p>当设置了ip参数，URL中指定的地址将会被忽略。<br>当设置了peer参数(见下方说明)，以上参数会被peer参数覆盖。</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/lb01.png"></p>
<p>当为一个层级指定了多个节点，GOST会将这些节点按指定顺序放在同一个节点组中。</p>
<p>每次客户端发送请求，代理链会先确定一条路径，对每一个节点组执行节点选择(随机或轮询)。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/lb02.png"></p>
<p>相当于将上面的命令转化为：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;http:&#x2F;&#x2F;192.168.1.3:8082 -F&#x3D;socks5:&#x2F;&#x2F;172.20.1.2:1081</span><br></pre></td></tr></table></figure>
<p>若地址比较多，可以使用外部配置文件：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;http:&#x2F;&#x2F;localhost:8080?ip&#x3D;iplist1.txt -F&#x3D;socks5:&#x2F;&#x2F;localhost:1080?ip&#x3D;iplist2.txt</span><br></pre></td></tr></table></figure>
<p>配置文件的格式为(按行分割的地址列表)：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">192.168.1.1</span><br><span class="line">192.168.1.2:8081</span><br><span class="line">192.168.1.3:8082</span><br><span class="line">example.com:8083</span><br></pre></td></tr></table></figure>
<p>在简单型中要求每一层级的所有节点的类型和配置保持一致。</p>
<h2 id="复杂型"><a href="#复杂型" class="headerlink" title="复杂型"></a>复杂型</h2><p>复杂型克服了简单型中的限制，可以自由指定代理链中每一层级节点组中节点的类型。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/lb03.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080 -F&#x3D;kcp:&#x2F;&#x2F;192.168.1.1:8388?peer&#x3D;peer1.txt -F&#x3D;http2:&#x2F;&#x2F;172.20.1.1:443?peer&#x3D;peer2.txt</span><br></pre></td></tr></table></figure>
<p>客户端通过peer参数指定额外的节点配置文件，配置文件格式为：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># strategy for node selecting</span><br><span class="line">strategy        random</span><br><span class="line"></span><br><span class="line">max_fails       1</span><br><span class="line"></span><br><span class="line">fail_timeout    30s</span><br><span class="line"></span><br><span class="line"># period for live reloading</span><br><span class="line">reload          10s</span><br><span class="line"></span><br><span class="line"># peers</span><br><span class="line">peer    http:&#x2F;&#x2F;:18080</span><br><span class="line">peer    socks:&#x2F;&#x2F;:11080</span><br><span class="line">peer    ss:&#x2F;&#x2F;chacha20:123456@:18338</span><br></pre></td></tr></table></figure>
<p>格式说明:</p>
<p>strategy - 同strategy参数。</p>
<p>max_fails - 同max_fails参数。</p>
<p>fail_timeout - 同fail_timeout参数。</p>
<p>reload - 此配置文件支持热更新。此选项用来指定文件检查周期，默认关闭热更新。</p>
<p>peer - 指定节点列表。</p>
<p>每次客户端发送请求，代理链会确定一条路径，对每一个节点组执行节点选择(随机或轮询)。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/lb04.png"></p>
<h2 id="简单型-复杂型"><a href="#简单型-复杂型" class="headerlink" title="简单型+复杂型"></a>简单型+复杂型</h2><p>组合使用时，代理链会将每一层级上(通过ip和peer参数)指定的所有节点放在同一个节点组中，再对每一个节点组执行节点选择(随机或轮询)，最终确定一条路径：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/lb05.png"></p>
<p>完整的示例配置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost.json:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;Debug&quot;: false,</span><br><span class="line">    &quot;Retries&quot;: 3,</span><br><span class="line">    &quot;Routes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Retries&quot;: 3,</span><br><span class="line">            &quot;ServeNodes&quot;: [</span><br><span class="line">                &quot;:8888&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ChainNodes&quot;: [</span><br><span class="line">                &quot;:1080?peer&#x3D;peer.txt&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>peer.txt:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">strategy        random</span><br><span class="line">max_fails       1</span><br><span class="line">fail_timeout    30s</span><br><span class="line"></span><br><span class="line">reload          10s</span><br><span class="line"></span><br><span class="line"># peers</span><br><span class="line">peer    ss+kcp:&#x2F;&#x2F;aes-128-cfb:pass@[host]:port?ip&#x3D;ips.txt</span><br></pre></td></tr></table></figure>
<p>ips.txt:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">host1[:port]</span><br><span class="line">host2[:port]</span><br><span class="line">host3[:port]</span><br></pre></td></tr></table></figure>
<h1 id="路由控制"><a href="#路由控制" class="headerlink" title="路由控制"></a>路由控制</h1><p>GOST在2.6版本中增加了路由控制功能，可以通过黑白名单来控制客户端的请求。路由控制可以应用于服务节点(-L参数)和代理链的所有层级节点(-F参数)。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080?bypass&#x3D;127.0.0.1,192.168.1.0&#x2F;24,.example.net -F&#x3D;:1080?bypass&#x3D;172.10.0.0&#x2F;16,localhost,*.example.com</span><br></pre></td></tr></table></figure>

<p>通过bypass参数来指定请求的目标地址列表(以逗号分割的IP,CIDR,域名或域名通配符地址)。</p>
<p>当执行代理链的节点选择时，每当确定一个代理链层级节点后，会应用此节点上的路由配置(bypass参数)，若此次请求的目标地址包含在此配置中，则代理链终止于此节点(且不包含此节点)。</p>
<p>若地址比较多，可以使用外部配置文件：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L :8080?bypass&#x3D;bypass.txt -F :1080?bypass&#x3D;bypass2.txt</span><br></pre></td></tr></table></figure>
<p>配置文件的格式为(地址列表和可选的配置项)：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># options</span><br><span class="line">reload   10s</span><br><span class="line">reverse  true</span><br><span class="line"></span><br><span class="line"># bypass addresses</span><br><span class="line">127.0.0.1</span><br><span class="line">172.10.0.0&#x2F;16</span><br><span class="line">localhost</span><br><span class="line">*.example.com</span><br><span class="line">.example.org</span><br></pre></td></tr></table></figure>
<p>reload - 此配置文件支持热更新。此选项用来指定文件检查周期，默认关闭热更新。</p>
<p>reverse - 指定是否切换为白名单。</p>
<p>若要转换为白名单，则通过在bypass参数值前添加~前缀：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080?bypass&#x3D;~127.0.0.1,172.10.0.0&#x2F;16,localhost,*.example.com,.example.org</span><br></pre></td></tr></table></figure>
<p>对于文件方式也是一样：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080?bypass&#x3D;~bypass.txt</span><br></pre></td></tr></table></figure>
<h1 id="DNS解析"><a href="#DNS解析" class="headerlink" title="DNS解析"></a>DNS解析</h1><p>GOST在2.6版本中可以自定义DNS解析。DNS解析应用于服务节点。</p>
<p>每当节点收到请求时，会使用此节点上指定的DNS解析器对此请求的目标地址进行解析。</p>
<h2 id="使用说明-10"><a href="#使用说明-10" class="headerlink" title="使用说明"></a>使用说明</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;http:&#x2F;&#x2F;:8080?dns&#x3D;8.8.8.8,1.1.1.1:53&#x2F;tcp,1.1.1.1:853&#x2F;tls,https:&#x2F;&#x2F;1.0.0.1&#x2F;dns-query</span><br></pre></td></tr></table></figure>
<h2 id="参数项"><a href="#参数项" class="headerlink" title="参数项"></a>参数项</h2><p>dns - 指定DNS服务列表(以逗号分割)，每个DNS服务的格式为：ip[:port][/protocol]，其中port默认为53，protocol可选值有：udp，udp-chain，tcp，tcp-chain，tls，tls-chain，https，https-chain。默认值为udp。</p>
<h2 id="代理链-2-10-0"><a href="#代理链-2-10-0" class="headerlink" title="代理链(2.10.0+)"></a>代理链(2.10.0+)</h2><p>如果需要通过代理链来连接DNS服务器，则可以使用以下protocols:</p>
<p>udp-chain, tcp-chain, tls-chain, https-chain</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;http:&#x2F;&#x2F;:8080?dns&#x3D;8.8.8.8&#x2F;udp-chain,1.1.1.1:853&#x2F;tls-chain,https-chain:&#x2F;&#x2F;dns.google&#x2F;dns-query -F&#x3D;socks:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果要转发udp-chain，代理链的末端(最后一个-F参数)必须是GOST socks5或ssu类型代理。</p>
</blockquote>
<h2 id="配置文件-1"><a href="#配置文件-1" class="headerlink" title="配置文件"></a>配置文件</h2><p>也可以使用外部文件来指定DNS服务列表：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080?dns&#x3D;dns.txt</span><br></pre></td></tr></table></figure>
<p>配置文件的格式为(按行分割的地址列表)：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># options</span><br><span class="line">timeout     5s</span><br><span class="line"># ttl       60s</span><br><span class="line">reload      10s</span><br><span class="line"></span><br><span class="line"># prefer    ipv6</span><br><span class="line"></span><br><span class="line"># ip        1.2.3.4</span><br><span class="line"></span><br><span class="line"># ip[:port] [protocol] [hostname]</span><br><span class="line">8.8.8.8</span><br><span class="line">8.8.8.8     tcp</span><br><span class="line">1.1.1.1     udp</span><br><span class="line">1.1.1.1:53  tcp-chain</span><br><span class="line">1.1.1.1:853 tls     cloudflare-dns.com</span><br><span class="line">https:&#x2F;&#x2F;1.0.0.1&#x2F;dns-query   https-chain</span><br></pre></td></tr></table></figure>
<p>timeout - DNS请求超时时间，默认5秒。</p>
<p>ttl - DNS缓存有效期，默认使用DNS查询返回结果中的TTL。当设置为负值，则不使用缓存。</p>
<p>reload - 此配置文件支持热更新。此选项用来指定文件检查周期，默认关闭热更新。</p>
<p>prefer - (2.8.2+) AAAA(IPv6)优先于A(IPv4)。</p>
<p>ip - 2.10.1+，客户端IP，设置后会开启ECS(EDNS Client Subnet)扩展功能。</p>
<p>DNS服务项分为三列：</p>
<p>第一列为DNS服务器地址，格式为ip[:port]，port默认为53.</p>
<p>第二列为协议类型，可选值有：udp，udp-chain，tcp，tcp-chain，tls，tls-chain，https，https-chain。 默认为udp。</p>
<p>第三列为DNS服务域名，当协议类型为tls，tls-chain，https，https-chain时有效，用于TLS证书校验。</p>
<h2 id="自定义域名解析"><a href="#自定义域名解析" class="headerlink" title="自定义域名解析"></a>自定义域名解析</h2><p>除了可以自定义DNS服务用来解析域名外，还可以手动指定域名-IP映射关系，类似于Linux下的/etc/hosts文件功能。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;:8080?hosts&#x3D;hosts.txt</span><br></pre></td></tr></table></figure>
<p>配置文件的格式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># options</span><br><span class="line">reload  10s</span><br><span class="line"></span><br><span class="line"># IP_address    canonical_hostname     [aliases...]</span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">192.168.1.10    foo.mydomain.org       foo</span><br><span class="line">192.168.1.13    bar.mydomain.org       bar baz</span><br></pre></td></tr></table></figure>
<p>reload - 此配置文件支持热更新。此选项用来指定文件检查周期，默认关闭热更新。</p>
<p>映射表项分为三列：</p>
<p>第一列为IP地址。</p>
<p>第二列为主机名或域名。</p>
<p>第三列为别名，可以有多个。</p>
<h1 id="DNS代理"><a href="#DNS代理" class="headerlink" title="DNS代理"></a>DNS代理</h1><p>GOST在2.10版本中增加了DNS代理服务。</p>
<h2 id="使用说明-11"><a href="#使用说明-11" class="headerlink" title="使用说明"></a>使用说明</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;dns:&#x2F;&#x2F;:1053?mode&#x3D;udp&amp;dns&#x3D;8.8.8.8,1.1.1.1:53&#x2F;tcp,1.1.1.1:853&#x2F;tls,https:&#x2F;&#x2F;1.0.0.1&#x2F;dns-query&quot;</span><br></pre></td></tr></table></figure>
<h2 id="参数项-1"><a href="#参数项-1" class="headerlink" title="参数项"></a>参数项</h2><p>mode - 指定代理服务的运行模式，可选值：udp，tcp，tls，https。默认值为udp。</p>
<p>dns - 与DNS解析中的dns参数功能和使用方式相同。</p>
<p>ttl - 2.10.1+，缓存过期时间，设置负值则禁用缓存，默认使用查询结果中的过期时间。</p>
<p>timeout - 2.10.1+，请求超时时间，默认5s。</p>
<p>ip - 2.10.1+，客户端IP，设置后会开启ECS(EDNS Client Subnet)扩展功能。</p>
<h1 id="TUN-TAP设备"><a href="#TUN-TAP设备" class="headerlink" title="TUN/TAP设备"></a>TUN/TAP设备</h1><p>GOST在2.9版本中增加了对TUN/TAP设备的支持。基于TUN/TAP设备可以简单的构建VPN。</p>
<h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p>Windows下需要安装tap驱动后才能使用，可以选择安装<a target="_blank" rel="noopener" href="https://github.com/OpenVPN/tap-windows6">OpenVPN/tap-windows6</a>或<a target="_blank" rel="noopener" href="https://github.com/OpenVPN/openvpn">OpenVPN client</a>。</p>
<h2 id="TUN"><a href="#TUN" class="headerlink" title="TUN"></a>TUN</h2><p>使用说明</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;tun:&#x2F;&#x2F;[method:[email protected]][local_ip]:port[&#x2F;remote_ip:port]?net&#x3D;192.168.123.2&#x2F;24&amp;name&#x3D;tun0&amp;mtu&#x3D;1350&amp;route&#x3D;10.100.0.0&#x2F;16&amp;gw&#x3D;192.168.123.1&quot;</span><br></pre></td></tr></table></figure>
<p>method:password - 可选，指定UDP隧道数据加密方法和密码。所支持的加密方法与<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/go-shadowsocks2">shadowsocks/go-shadowsocks2</a>一致。</p>
<p>local_ip:port - 必须，本地监听的UDP隧道地址。</p>
<p>remote_ip:port - 可选，目标UDP地址。本地TUN设备收到的IP包会通过UDP转发到此地址。</p>
<p>net - 必须，指定TUN设备的地址。</p>
<p>name - 可选，指定TUN设备的名字，默认值为系统预设。</p>
<p>mtu - 可选，设置TUN设备的MTU值，默认值为1350。</p>
<p>route - 可选，逗号分割的路由列表:，例如：10.100.0.0/16,172.20.1.0/24,1.2.3.4/32</p>
<p>gw - 可选，设置TUN设备路由默认网关IP。</p>
<p>tcp - 可选，是否使用fake TCP隧道，默认false。</p>
<h2 id="服务端路由-2-9-2"><a href="#服务端路由-2-9-2" class="headerlink" title="服务端路由(2.9.2+)"></a>服务端路由(2.9.2+)</h2><p>服务端可以通过设置路由表和网关，来访问客户端所在的网络。</p>
<p>默认网关<br>服务端可以通过gw参数设置默认网关，来指定route参数的路由路径。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;tun:&#x2F;&#x2F;:8421?net&#x3D;192.168.123.1&#x2F;24&amp;gw&#x3D;192.168.123.2&amp;route&#x3D;172.10.0.0&#x2F;16,10.138.0.0&#x2F;16&quot;</span><br></pre></td></tr></table></figure>
<p>发往172.10.0.0/16和10.138.0.0/16网络的数据会通过TUN隧道转发给IP为192.168.123.2的客户端。</p>
<p>特定网关路由<br>如果要针对每个路由设置特定的网关，可以通过路由配置文件来指定：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;tun:&#x2F;&#x2F;:8421?net&#x3D;192.168.123.1&#x2F;24&amp;route&#x3D;route.txt&quot;</span><br></pre></td></tr></table></figure>
<p>配置文件route.txt的格式为：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Destination   Gateway</span><br><span class="line"></span><br><span class="line">172.10.0.0&#x2F;16   192.168.123.2</span><br><span class="line">10.138.0.0&#x2F;16   192.168.123.3</span><br></pre></td></tr></table></figure>
<p>第一列为目标网络。</p>
<p>第二列为网关IP，若为空则使用gw参数设置的默认网关IP。</p>
<p>发往172.10.0.0/16网络的数据会通过TUN隧道转发给IP为192.168.123.2的客户端。 发往10.138.0.0/16网络的数据会通过TUN隧道转发给IP为192.168.123.3的客户端。</p>
<h2 id="构建基于TUN设备的VPN-Linux"><a href="#构建基于TUN设备的VPN-Linux" class="headerlink" title="构建基于TUN设备的VPN (Linux)"></a>构建基于TUN设备的VPN (Linux)</h2><blockquote>
<p>net所指定的地址可能需要根据实际情况进行调整。</p>
</blockquote>
<h3 id="创建TUN设备并建立UDP隧道"><a href="#创建TUN设备并建立UDP隧道" class="headerlink" title="创建TUN设备并建立UDP隧道"></a>创建TUN设备并建立UDP隧道</h3><p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tun:&#x2F;&#x2F;:8421?net&#x3D;192.168.123.1&#x2F;24</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tun:&#x2F;&#x2F;:8421&#x2F;SERVER_IP:8421?net&#x3D;192.168.123.2&#x2F;24</span><br></pre></td></tr></table></figure>
<p>当以上命令运行无误后，可以通过ip addr命令来查看创建的TUN设备：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ip addr show tun0</span><br><span class="line">2: tun0: &lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1350 qdisc pfifo_fast state UNKNOWN group default qlen 500</span><br><span class="line">    link&#x2F;none </span><br><span class="line">    inet 192.168.123.2&#x2F;24 scope global tun0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::d521:ad59:87d0:53e4&#x2F;64 scope link flags 800 </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure>
<p>可以通过在客户端执行ping命令来测试一下隧道是否连通：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ping 192.168.123.1</span><br><span class="line">64 bytes from 192.168.123.1: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;9.12 ms</span><br><span class="line">64 bytes from 192.168.123.1: icmp_seq&#x3D;2 ttl&#x3D;64 time&#x3D;10.3 ms</span><br><span class="line">64 bytes from 192.168.123.1: icmp_seq&#x3D;3 ttl&#x3D;64 time&#x3D;7.18 ms</span><br></pre></td></tr></table></figure>
<p>如果能ping通，说明隧道已经成功建立。</p>
<p>iperf3测试<br>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ iperf3 -s</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ iperf3 -c 192.168.123.1</span><br></pre></td></tr></table></figure>
<p>路由规则和防火墙设置<br>如果想让客户端访问到服务端的网络，还需要根据需求设置相应的路由和防火墙规则。例如可以将客户端的所有外网流量转发给服务端处理</p>
<p>服务端<br>开启IP转发并设置防火墙规则</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ sysctl -w net.ipv4.ip_forward&#x3D;1</span><br><span class="line"></span><br><span class="line">$ iptables -t nat -A POSTROUTING -s 192.168.123.0&#x2F;24 ! -o tun0 -j MASQUERADE</span><br><span class="line">$ iptables -A FORWARD -i tun0 ! -o tun0 -j ACCEPT</span><br><span class="line">$ iptables -A FORWARD -o tun0 -j ACCEPT</span><br></pre></td></tr></table></figure>
<p>客户端<br>设置路由规则</p>
<blockquote>
<p>以下操作会更改客户端的网络环境，除非你知道自己在做什么，请谨慎操作！</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ip route add SERVER_IP&#x2F;32 dev eth0   # 请根据实际情况替换SERVER_IP和eth0</span><br><span class="line">$ ip route del default   # 删除默认的路由</span><br><span class="line">$ ip route add default via 192.168.123.2  # 使用</span><br></pre></td></tr></table></figure>
<h2 id="TAP"><a href="#TAP" class="headerlink" title="TAP"></a>TAP</h2><blockquote>
<p>目前不支持MacOS。</p>
</blockquote>
<h2 id="使用说明-12"><a href="#使用说明-12" class="headerlink" title="使用说明"></a>使用说明</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L&#x3D;&quot;tap:&#x2F;&#x2F;[method:password@][local_ip]:port[&#x2F;remote_ip:port]?net&#x3D;192.168.123.2&#x2F;24&amp;name&#x3D;tap0&amp;mtu&#x3D;1350&amp;route&#x3D;10.100.0.0&#x2F;16&amp;gw&#x3D;192.168.123.1&quot;</span><br></pre></td></tr></table></figure>
<h2 id="基于TCP的TUN-TAP隧道"><a href="#基于TCP的TUN-TAP隧道" class="headerlink" title="基于TCP的TUN/TAP隧道"></a>基于TCP的TUN/TAP隧道</h2><p>GOST中的TUN/TAP隧道默认是基于UDP协议进行数据传输。</p>
<p>如果想使用TCP传输，可以选择采用以下几种方式：</p>
<h3 id="Fake-TCP"><a href="#Fake-TCP" class="headerlink" title="Fake TCP"></a>Fake TCP</h3><blockquote>
<p>Fake TCP不是标准的TCP，只是模拟了TCP协议。<br>此功能仅适用于Linux。</p>
</blockquote>
<p>GOST中采用<a target="_blank" rel="noopener" href="https://github.com/xtaci/tcpraw">xtaci/tcpraw</a>内置了对TCP的支持。通过tcp参数开启此功能。</p>
<p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L &quot;tun:&#x2F;&#x2F;:8421?net&#x3D;192.168.123.1&#x2F;24&amp;tcp&#x3D;true&quot;</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L &quot;tun:&#x2F;&#x2F;:0&#x2F;SERVER_IP:8421?net&#x3D;192.168.123.2&#x2F;24&amp;tcp&#x3D;true&quot;</span><br></pre></td></tr></table></figure>
<h3 id="代理链-2-9-1"><a href="#代理链-2-9-1" class="headerlink" title="代理链 (2.9.1+)"></a>代理链 (2.9.1+)</h3><p>可以通过使用代理链进行转发，用法与UDP本地端口转发类似。</p>
<p>此方式比较灵活通用，推荐使用。</p>
<blockquote>
<p>代理链的末端(最后一个-F参数)节点必须支持GOST socks5或ssu协议类型，传输层可以任意选择。<br>使用ssu需要2.10.1+版本。</p>
</blockquote>
<p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tun:&#x2F;&#x2F;:8421?net&#x3D;192.168.123.1&#x2F;24&quot; -L socks5:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tun:&#x2F;&#x2F;:0&#x2F;:8421?net&#x3D;192.168.123.2&#x2F;24 -F socks5:&#x2F;&#x2F;SERVER_IP:1080</span><br></pre></td></tr></table></figure>
<p>端口转发<br>利用UDP端口转发配合代理链。</p>
<p>服务端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tun:&#x2F;&#x2F;:8421?net&#x3D;192.168.123.1&#x2F;24 -L socks5:&#x2F;&#x2F;:1080</span><br></pre></td></tr></table></figure>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gost -L tun:&#x2F;&#x2F;:8421&#x2F;:8420?net&#x3D;192.168.123.2&#x2F;24 -L udp:&#x2F;&#x2F;:8420&#x2F;:8421 -F socks5:&#x2F;&#x2F;server_ip:1080</span><br></pre></td></tr></table></figure>
<p>第三方转发工具<br><a target="_blank" rel="noopener" href="https://github.com/wangyu-/udp2raw-tunnel">udp2raw-tunnel</a>。</p>
<hr>
<blockquote>
<p>转载自<a target="_blank" rel="noopener" href="https://docs.ginuerzh.xyz/gost/">https://docs.ginuerzh.xyz/gost/</a></p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">EdNovas</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://ednovas.xyz/2021/05/24/gost/">https://ednovas.xyz/2021/05/24/gost/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/vps/">vps</a><a class="post-meta__tags" href="/tags/gost/">gost</a><a class="post-meta__tags" href="/tags/go-simple-tunnel/">go simple tunnel</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/gosttunnel.png" data-sites="qq,wechat,weibo,qzone"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="ads-wrap"><a href="https://ednovas.net/" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/QQ图片20210405210546.png"><center><h3>EdNovas云————EdNovas自己搞的机场，不想来试试嘛？</h3></center></a> <a href="https://antlink.cc/#/register?code=Wa3WBPHC" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/04-24_12-14-24.png"><center><h3>AntLink蚁链————新用户注册免费使用50g/30天，便宜IPLC机场</h3></center></a> <a href="https://i.ok9.icu/kq7w" target="_blank"><img src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/Snipaste_2021-10-22_10-16-00-1.png"><center><h3>更快更稳，新一代全球加速。1元体验1天5GB顶级流量，赠送P站、X站、奈飞付费会员！全球多个数据中心，让您上网无忧！</h3></center></a></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/05/24/darkweb/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/20703217_G.jpeg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/silhouette-seashore-pink-sky-man-standing-smoke-can-sunset-5120x2880-3150.webp'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">别好奇，暗网真的没意思</div></div></a></div><div class="next-post pull-right"><a href="/2021/05/24/wireguard/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/WireGuard-logo.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/silhouette-seashore-pink-sky-man-standing-smoke-can-sunset-5120x2880-3150.webp'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Debian Linux VPS 服务器 WireGuard 安装教程</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2021/05/24/wireguard/" title="Debian Linux VPS 服务器 WireGuard 安装教程"><img class="cover" src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/WireGuard-logo.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-24</div><div class="title">Debian Linux VPS 服务器 WireGuard 安装教程</div></div></a></div><div><a href="/2021/05/02/unattended-upgrade/" title="VPS unattended-upgrade占用100%问题解决"><img class="cover" src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/the-best-cpus-for-gaming-2019-hero1567181382948504.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-02</div><div class="title">VPS unattended-upgrade占用100%问题解决</div></div></a></div><div><a href="/2021/05/02/githubactions/" title="使用 SSH 连接 GitHub Action 服务器"><img class="cover" src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/442-github-actions.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-02</div><div class="title">使用 SSH 连接 GitHub Action 服务器</div></div></a></div><div><a href="/2021/04/27/redis/" title="Redis安装报错"><img class="cover" src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/1498119653712274.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-27</div><div class="title">Redis安装报错</div></div></a></div><div><a href="/2021/04/27/wordpress/" title="Wordpress搭建个人博客"><img class="cover" src="https://cdn.jsdelivr.net/gh/wdm1732418365/CDN/New%20folder/wordpress-backup00.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-27</div><div class="title">Wordpress搭建个人博客</div></div></a></div><div><a href="/2021/04/22/newproxypool/" title="搭建proxypool节点池（go）"><img class="cover" src="https://api.ixiaowai.cn/gqapi/gqapi.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-22</div><div class="title">搭建proxypool节点池（go）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E7%89%B9%E6%80%A7"><span class="toc-number">1.</span> <span class="toc-text">功能特性</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">下载安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">二进制文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91"><span class="toc-number">2.2.</span> <span class="toc-text">源码编译</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker"><span class="toc-number">2.3.</span> <span class="toc-text">Docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shadowsocks-Android%E6%8F%92%E4%BB%B6"><span class="toc-number">2.4.</span> <span class="toc-text">Shadowsocks Android插件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%BB%BA%E8%AE%AE"><span class="toc-number">3.</span> <span class="toc-text">问题建议</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B"><span class="toc-number">4.</span> <span class="toc-text">快速开始</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E8%BF%90%E8%A1%8C"><span class="toc-number">4.1.</span> <span class="toc-text">启动运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.2.</span> <span class="toc-text">开启代理服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E5%A4%9A%E4%B8%AA%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.3.</span> <span class="toc-text">开启多个代理服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86"><span class="toc-number">4.4.</span> <span class="toc-text">使用转发代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%BA%A7%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86-%E4%BB%A3%E7%90%86%E9%93%BE"><span class="toc-number">4.5.</span> <span class="toc-text">使用多级转发代理(代理链)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0"><span class="toc-number">4.6.</span> <span class="toc-text">启动参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.7.</span> <span class="toc-text">配置文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E9%85%8D%E7%BD%AE"><span class="toc-number">5.</span> <span class="toc-text">节点配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E7%B1%BB%E5%9E%8B-Protocols"><span class="toc-number">5.1.</span> <span class="toc-text">协议类型(Protocols)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E7%B1%BB%E5%9E%8B-Transports"><span class="toc-number">5.2.</span> <span class="toc-text">传输类型(Transports)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%A0%BC%E5%BC%8F"><span class="toc-number">5.3.</span> <span class="toc-text">配置格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#scheme"><span class="toc-number">5.4.</span> <span class="toc-text">scheme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E6%8C%87%E5%AE%9A%E4%BB%BB%E4%BD%95%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.5.</span> <span class="toc-text">不指定任何类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%85%E6%8C%87%E5%AE%9A%E5%8D%8F%E8%AE%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.6.</span> <span class="toc-text">仅指定协议类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%85%E6%8C%87%E5%AE%9A%E4%BC%A0%E8%BE%93%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.7.</span> <span class="toc-text">仅指定传输类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">5.8.</span> <span class="toc-text">组合使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84schemes"><span class="toc-number">5.9.</span> <span class="toc-text">特殊的schemes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E8%AE%A4%E8%AF%81"><span class="toc-number">5.10.</span> <span class="toc-text">节点认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#user-pass"><span class="toc-number">5.11.</span> <span class="toc-text">user:pass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#auth%E5%8F%82%E6%95%B0-2-9-2"><span class="toc-number">5.12.</span> <span class="toc-text">auth参数 (2.9.2+)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#secrets%E5%8F%82%E6%95%B0"><span class="toc-number">5.13.</span> <span class="toc-text">secrets参数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HTTPS-S"><span class="toc-number">6.</span> <span class="toc-text">HTTPS(S)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E5%87%86HTTP%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1"><span class="toc-number">6.1.</span> <span class="toc-text">标准HTTP代理服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E5%87%86HTTPS%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1"><span class="toc-number">6.2.</span> <span class="toc-text">标准HTTPS代理服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-Over-Websocket"><span class="toc-number">6.3.</span> <span class="toc-text">HTTP Over Websocket</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-Over-KCP"><span class="toc-number">6.4.</span> <span class="toc-text">HTTP Over KCP</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HTTP2"><span class="toc-number">7.</span> <span class="toc-text">HTTP2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.1.</span> <span class="toc-text">代理模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%A7%E9%81%93%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.2.</span> <span class="toc-text">隧道模式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A2%E6%B5%8B%E9%98%B2%E5%BE%A1"><span class="toc-number">8.</span> <span class="toc-text">探测防御</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#probe-resist"><span class="toc-number">8.1.</span> <span class="toc-text">probe_resist</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#knock%EF%BC%882-8"><span class="toc-number">8.2.</span> <span class="toc-text">knock（2.8+)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SCOKS"><span class="toc-number">9.</span> <span class="toc-text">SCOKS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SOCKS4"><span class="toc-number">9.1.</span> <span class="toc-text">SOCKS4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SOCKS4A"><span class="toc-number">9.2.</span> <span class="toc-text">SOCKS4A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SOCKS5"><span class="toc-number">9.3.</span> <span class="toc-text">SOCKS5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SOCKS5%E5%8D%8F%E5%95%86%E5%8A%A0%E5%AF%86"><span class="toc-number">9.4.</span> <span class="toc-text">SOCKS5协商加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">9.5.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">9.6.</span> <span class="toc-text">客户端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SOCKS5-UDP-Relay"><span class="toc-number">9.7.</span> <span class="toc-text">SOCKS5 UDP Relay</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SOCKS5-Over-TLS"><span class="toc-number">9.8.</span> <span class="toc-text">SOCKS5 Over TLS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SOCKS5-Over-QUIC"><span class="toc-number">9.9.</span> <span class="toc-text">SOCKS5 Over QUIC</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Shadowsocks"><span class="toc-number">10.</span> <span class="toc-text">Shadowsocks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="toc-number">10.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP"><span class="toc-number">10.2.</span> <span class="toc-text">TCP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">10.2.1.</span> <span class="toc-text">参数说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-1"><span class="toc-number">10.2.2.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-1"><span class="toc-number">10.2.3.</span> <span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AEAD%E5%8A%A0%E5%AF%86"><span class="toc-number">10.3.</span> <span class="toc-text">AEAD加密</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-2"><span class="toc-number">10.3.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-2"><span class="toc-number">10.3.2.</span> <span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="toc-number">10.4.</span> <span class="toc-text">组合传输层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Shadowsocks-Over-TLS"><span class="toc-number">10.4.1.</span> <span class="toc-text">Shadowsocks Over TLS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shadowsocks-Over-KCP"><span class="toc-number">10.4.2.</span> <span class="toc-text">Shadowsocks Over KCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UDP"><span class="toc-number">10.5.</span> <span class="toc-text">UDP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-3"><span class="toc-number">10.5.1.</span> <span class="toc-text">服务端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-%E5%90%8E%E7%9A%84%E5%8F%98%E5%8C%96"><span class="toc-number">10.6.</span> <span class="toc-text">2.10+后的变化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%94%AF%E6%8C%81"><span class="toc-number">10.7.</span> <span class="toc-text">客户端支持</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E6%96%B9%E6%B3%95"><span class="toc-number">10.8.</span> <span class="toc-text">加密方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E4%BC%A0%E8%BE%93%E5%B1%82-1"><span class="toc-number">10.9.</span> <span class="toc-text">组合传输层</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SNI"><span class="toc-number">11.</span> <span class="toc-text">SNI</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-1"><span class="toc-number">11.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-4"><span class="toc-number">11.2.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-3"><span class="toc-number">11.3.</span> <span class="toc-text">客户端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Host%E6%B7%B7%E6%B7%86"><span class="toc-number">11.4.</span> <span class="toc-text">Host混淆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SNI-Over-TLS"><span class="toc-number">11.5.</span> <span class="toc-text">SNI Over TLS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SNI-Over-Websocket"><span class="toc-number">11.6.</span> <span class="toc-text">SNI Over Websocket</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TLS"><span class="toc-number">12.</span> <span class="toc-text">TLS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-2"><span class="toc-number">12.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E5%87%86TLS"><span class="toc-number">12.2.</span> <span class="toc-text">标准TLS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-5"><span class="toc-number">12.2.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-4"><span class="toc-number">12.2.2.</span> <span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8TLS"><span class="toc-number">12.3.</span> <span class="toc-text">多路复用TLS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-6"><span class="toc-number">12.3.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-5"><span class="toc-number">12.3.2.</span> <span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TLS%E8%AF%81%E4%B9%A6"><span class="toc-number">12.4.</span> <span class="toc-text">TLS证书</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%81%E4%B9%A6%E6%A0%A1%E9%AA%8C"><span class="toc-number">12.5.</span> <span class="toc-text">证书校验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%81%E4%B9%A6%E9%94%81%E5%AE%9A"><span class="toc-number">12.6.</span> <span class="toc-text">证书锁定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E5%90%91%E8%AF%81%E4%B9%A6%E6%A0%A1%E9%AA%8C-2-11-1"><span class="toc-number">12.7.</span> <span class="toc-text">双向证书校验(2.11.1+)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Websocket"><span class="toc-number">13.</span> <span class="toc-text">Websocket</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-3"><span class="toc-number">13.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E-1"><span class="toc-number">13.2.</span> <span class="toc-text">参数说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E5%87%86Websocket"><span class="toc-number">13.3.</span> <span class="toc-text">标准Websocket</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Multiplex-Websocket"><span class="toc-number">13.4.</span> <span class="toc-text">Multiplex Websocket</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Websocket-Secure"><span class="toc-number">13.5.</span> <span class="toc-text">Websocket Secure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Multiplex-Websocket-Secure"><span class="toc-number">13.6.</span> <span class="toc-text">Multiplex Websocket Secure</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#KCP"><span class="toc-number">14.</span> <span class="toc-text">KCP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-4"><span class="toc-number">14.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-7"><span class="toc-number">14.2.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-6"><span class="toc-number">14.3.</span> <span class="toc-text">客户端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">14.4.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fake-TCP-2-9-1"><span class="toc-number">14.5.</span> <span class="toc-text">Fake TCP (2.9.1+)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-8"><span class="toc-number">14.6.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-7"><span class="toc-number">14.7.</span> <span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QUIC"><span class="toc-number">15.</span> <span class="toc-text">QUIC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-5"><span class="toc-number">15.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-9"><span class="toc-number">15.2.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-8"><span class="toc-number">15.3.</span> <span class="toc-text">客户端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%83%E8%B7%B3"><span class="toc-number">15.4.</span> <span class="toc-text">心跳</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SSH"><span class="toc-number">16.</span> <span class="toc-text">SSH</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-6"><span class="toc-number">16.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-10"><span class="toc-number">16.2.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-9"><span class="toc-number">16.3.</span> <span class="toc-text">客户端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">16.4.</span> <span class="toc-text">端口转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PubKey%E8%AE%A4%E8%AF%81-2-11"><span class="toc-number">16.5.</span> <span class="toc-text">PubKey认证 (2.11+)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Simple-obfs"><span class="toc-number">17.</span> <span class="toc-text">Simple-obfs</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-7"><span class="toc-number">17.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#obfs-http"><span class="toc-number">17.2.</span> <span class="toc-text">obfs-http</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#obfs-tls-2-11"><span class="toc-number">17.3.</span> <span class="toc-text">obfs-tls (2.11+)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Obfs4"><span class="toc-number">18.</span> <span class="toc-text">Obfs4</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86"><span class="toc-number">19.</span> <span class="toc-text">透明代理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP-1"><span class="toc-number">19.1.</span> <span class="toc-text">TCP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%85%A8%E5%B1%80TCP%E4%BB%A3%E7%90%86%EF%BC%9A"><span class="toc-number">19.2.</span> <span class="toc-text">本地全局TCP代理：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UDP-2-10"><span class="toc-number">19.3.</span> <span class="toc-text">UDP (2.10+)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%85%A8%E5%B1%80UDP%E4%BB%A3%E7%90%86"><span class="toc-number">19.4.</span> <span class="toc-text">本地全局UDP代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEiptables%E8%A7%84%E5%88%99"><span class="toc-number">19.4.1.</span> <span class="toc-text">设置iptables规则</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91-1"><span class="toc-number">20.</span> <span class="toc-text">端口转发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-8"><span class="toc-number">20.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E-2"><span class="toc-number">20.2.</span> <span class="toc-text">参数说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E6%9C%AC%E5%9C%B0%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">20.3.</span> <span class="toc-text">TCP本地端口转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E8%BF%9C%E7%A8%8B%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">20.4.</span> <span class="toc-text">TCP远程端口转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SOCKS5%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">20.5.</span> <span class="toc-text">SOCKS5多路复用模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%A8%A1%E5%BC%8F"><span class="toc-number">20.6.</span> <span class="toc-text">SSH端口转发模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UDP%E6%9C%AC%E5%9C%B0%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">20.7.</span> <span class="toc-text">UDP本地端口转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UDP%E8%BF%9C%E7%A8%8B%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">20.8.</span> <span class="toc-text">UDP远程端口转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E5%8F%91%E9%9A%A7%E9%81%93"><span class="toc-number">20.9.</span> <span class="toc-text">转发隧道</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">20.10.</span> <span class="toc-text">使用场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Relay"><span class="toc-number">21.</span> <span class="toc-text">Relay</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-9"><span class="toc-number">21.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E-3"><span class="toc-number">21.2.</span> <span class="toc-text">参数说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E5%8A%9F%E8%83%BD"><span class="toc-number">21.3.</span> <span class="toc-text">代理功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E5%8F%91%E5%8A%9F%E8%83%BD"><span class="toc-number">21.4.</span> <span class="toc-text">转发功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91-2"><span class="toc-number">21.4.1.</span> <span class="toc-text">端口转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E5%8F%91%E9%9A%A7%E9%81%93-1"><span class="toc-number">21.4.2.</span> <span class="toc-text">转发隧道</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-number">22.</span> <span class="toc-text">权限控制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">23.</span> <span class="toc-text">负载均衡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%9E%8B"><span class="toc-number">23.1.</span> <span class="toc-text">简单型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E-4"><span class="toc-number">23.2.</span> <span class="toc-text">参数说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E5%9E%8B"><span class="toc-number">23.3.</span> <span class="toc-text">复杂型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%9E%8B-%E5%A4%8D%E6%9D%82%E5%9E%8B"><span class="toc-number">23.4.</span> <span class="toc-text">简单型+复杂型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E6%8E%A7%E5%88%B6"><span class="toc-number">24.</span> <span class="toc-text">路由控制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DNS%E8%A7%A3%E6%9E%90"><span class="toc-number">25.</span> <span class="toc-text">DNS解析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-10"><span class="toc-number">25.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E9%A1%B9"><span class="toc-number">25.2.</span> <span class="toc-text">参数项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E9%93%BE-2-10-0"><span class="toc-number">25.3.</span> <span class="toc-text">代理链(2.10.0+)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1"><span class="toc-number">25.4.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">25.5.</span> <span class="toc-text">自定义域名解析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DNS%E4%BB%A3%E7%90%86"><span class="toc-number">26.</span> <span class="toc-text">DNS代理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-11"><span class="toc-number">26.1.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E9%A1%B9-1"><span class="toc-number">26.2.</span> <span class="toc-text">参数项</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TUN-TAP%E8%AE%BE%E5%A4%87"><span class="toc-number">27.</span> <span class="toc-text">TUN&#x2F;TAP设备</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows"><span class="toc-number">27.1.</span> <span class="toc-text">Windows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TUN"><span class="toc-number">27.2.</span> <span class="toc-text">TUN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%B7%AF%E7%94%B1-2-9-2"><span class="toc-number">27.3.</span> <span class="toc-text">服务端路由(2.9.2+)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%9F%BA%E4%BA%8ETUN%E8%AE%BE%E5%A4%87%E7%9A%84VPN-Linux"><span class="toc-number">27.4.</span> <span class="toc-text">构建基于TUN设备的VPN (Linux)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BATUN%E8%AE%BE%E5%A4%87%E5%B9%B6%E5%BB%BA%E7%AB%8BUDP%E9%9A%A7%E9%81%93"><span class="toc-number">27.4.1.</span> <span class="toc-text">创建TUN设备并建立UDP隧道</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TAP"><span class="toc-number">27.5.</span> <span class="toc-text">TAP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E-12"><span class="toc-number">27.6.</span> <span class="toc-text">使用说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8ETCP%E7%9A%84TUN-TAP%E9%9A%A7%E9%81%93"><span class="toc-number">27.7.</span> <span class="toc-text">基于TCP的TUN&#x2F;TAP隧道</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Fake-TCP"><span class="toc-number">27.7.1.</span> <span class="toc-text">Fake TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E9%93%BE-2-9-1"><span class="toc-number">27.7.2.</span> <span class="toc-text">代理链 (2.9.1+)</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By EdNovas</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">已经到底啦！再往下划要坏掉啦！</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'EnV5YLoyOBqrOXB9EDkMBSy4-gzGzoHsz',
      appKey: 'MCTWNHJYAMcvfKeta68Xi7Iu',
      placeholder: '留下你想说的话吧',
      avatar: 'monsterid',
      meta: 'nick,mail'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: true,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign(initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>var gitcalendar = new Vue({
  el: '#gitcalendar',
  data: {
    simplemode: false,
    user: 'wdm1732418365',
    fixed: 'fixed',
    px: 'px',
    x: '',
    y: '',
    span1: '',
    span2: '',
    month: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
    monthchange: [],
    oneyearbeforeday: '',
    thisday: '',
    amonthago: '',
    aweekago: '',
    weekdatacore: 0,
    datacore: 0,
    total: 0,
    datadate: '',
    data: [],
    positionplusdata: [],
    firstweek: [],
    lastweek: [],
    beforeweek: [],
    thisweekdatacore: 0,
    mounthbeforeday: 0,
    mounthfirstindex: 0,
    crispedges: 'crispedges',
    thisdayindex: 0,
    amonthagoindex: 0,
    amonthagoweek: [],
    firstdate: [],
    first2date: [],
    montharrbefore: [],
    monthindex: 0,
    color: ['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f']
  },
  methods: {
    selectStyle(data, event) {
      document.querySelector('.angle-wrapper').style.display = 'block'
      this.span1 = data.date;
      this.span2 = data.count;
      this.x = event.clientX - 100;
      this.y = event.clientY - 60
    },
    outStyle() {
      document.querySelector('.angle-wrapper').style.display = 'none'
    },
    thiscolor(x) {
      if (x === 0) {
        let i = parseInt(x / 2);
        return this.color[0]
      } else if (x < 2) {
        return this.color[1]
      } else if (x < 20) {
        let i = parseInt(x / 2);
        return this.color[i]
      } else {
        return this.color[9]
      }
    },
  }
});
var apiurl = 'github-calendar-api.vercel.app' ? 'https://github-calendar-api.vercel.app/api?' : 'https://githubapi.ryanchristian.dev/user/'
var githubapiurl = apiurl + gitcalendar.user;
//canvas绘图
function responsiveChart() {
  let c = document.getElementById("gitcanvas");
  if (c) {
    let cmessage = document.getElementById("gitmessage");
    let ctx = c.getContext("2d");
    c.width = document.getElementById("gitcalendarcanvasbox").offsetWidth;
    let linemaxwitdh = 0.96 * c.width / gitcalendar.data.length;
    c.height = 9 * linemaxwitdh;
    let lineminwitdh = 0.8 * linemaxwitdh;
    let setposition = {
      x: 0.02 * c.width,
      y: 0.025 * c.width
    };
    for (let week in gitcalendar.data) {
      weekdata = gitcalendar.data[week];
      for (let day in weekdata) {
        let dataitem = {
          date: "",
          count: "",
          x: 0,
          y: 0
        };
        gitcalendar.positionplusdata.push(dataitem);
        ctx.fillStyle = gitcalendar.thiscolor(weekdata[day].count);
        setposition.y = Math.round(setposition.y * 100) / 100;
        dataitem.date = weekdata[day].date;
        dataitem.count = weekdata[day].count;
        dataitem.x = setposition.x;
        dataitem.y = setposition.y;
        ctx.fillRect(setposition.x, setposition.y, lineminwitdh, lineminwitdh);
        setposition.y = setposition.y + linemaxwitdh
      };
      setposition.y = 0.025 * c.width;
      setposition.x = setposition.x + linemaxwitdh
    };
    ctx.font = "600  Arial";
    ctx.fillStyle = '#aaa';
    ctx.fillText("日", 0, 1.9 * linemaxwitdh);
    ctx.fillText("二", 0, 3.9 * linemaxwitdh);
    ctx.fillText("四", 0, 5.9 * linemaxwitdh);
    ctx.fillText("六", 0, 7.9 * linemaxwitdh);
    let monthindexlist = c.width / 24;
    for (let index in gitcalendar.monthchange) {
      ctx.fillText(gitcalendar.monthchange[index], monthindexlist, 0.7 * linemaxwitdh);
      monthindexlist = monthindexlist + c.width / 12
    };
    cmessage.onmousemove = function(event) {
      document.querySelector('.angle-wrapper').style.display = 'none'
    };
    c.onmousemove = function(event) {
      document.querySelector('.angle-wrapper').style.display = 'none'
      getMousePos(c, event);
    };

    function getMousePos(canvas, event) {
      var rect = canvas.getBoundingClientRect();
      var x = event.clientX - rect.left * (canvas.width / rect.width);
      var y = event.clientY - rect.top * (canvas.height / rect.height);
      //console.log("x:"+x+",y:"+y);
      for (let item of gitcalendar.positionplusdata) {
        let lenthx = x - item.x;
        let lenthy = y - item.y;
        //console.log(lenthx,lenthy);
        if (0 < lenthx && lenthx < lineminwitdh) {
          if (0 < lenthy && lenthy < lineminwitdh) {
            //console.log(item.date,item.count)
            document.querySelector('.angle-wrapper').style.display = 'block'
            gitcalendar.span1 = item.date;
            gitcalendar.span2 = item.count;
            gitcalendar.x = event.clientX - 100;
            gitcalendar.y = event.clientY - 60
          }
        }
        //if(0< x - item.x <lineminwitdh&&0< y - item.y <lineminwitdh){
        //console.log(item.count,item.date);
        //}
      }
    }
  }
}
//数据统计算法
function addlastmonth() {
  if (gitcalendar.thisdayindex === 0) {
    thisweekcore(52);
    thisweekcore(51);
    thisweekcore(50);
    thisweekcore(49);
    thisweekcore(48);
    gitcalendar.thisweekdatacore += gitcalendar.firstdate[6].count;
    gitcalendar.amonthago = gitcalendar.firstdate[6].date
  } else {
    thisweekcore(52);
    thisweekcore(51);
    thisweekcore(50);
    thisweekcore(49);
    thisweek2core();
    gitcalendar.amonthago = gitcalendar.first2date[gitcalendar.thisdayindex - 1].date
  }
};

function thisweek2core() {
  for (let i = gitcalendar.thisdayindex - 1; i < gitcalendar.first2date.length; i++) {
    gitcalendar.thisweekdatacore += gitcalendar.first2date[i].count
  }
};

function thisweekcore(index) {
  for (let item of gitcalendar.data[index]) {
    gitcalendar.thisweekdatacore += item.count
  }
};

function addlastweek() {
  for (let item of gitcalendar.lastweek) {
    gitcalendar.weekdatacore += item.count
  }
};

function addbeforeweek() {
  for (let i = gitcalendar.thisdayindex; i < gitcalendar.beforeweek.length; i++) {
    gitcalendar.weekdatacore += gitcalendar.beforeweek[i].count
  }
};

function addweek(data) {
  if (gitcalendar.thisdayindex === 6) {
    gitcalendar.aweekago = gitcalendar.lastweek[0].date;
    addlastweek()
  } else {
    lastweek = data.contributions[51];
    gitcalendar.aweekago = lastweek[gitcalendar.thisdayindex + 1].date;
    addlastweek();
    addbeforeweek()
  }
}

fetch(githubapiurl)
  .then(data => data.json())
  .then(data => {
    gitcalendar.data = data.contributions;
    gitcalendar.total = data.total;
    gitcalendar.first2date = gitcalendar.data[48];
    gitcalendar.firstdate = gitcalendar.data[47];
    gitcalendar.firstweek = data.contributions[0];
    gitcalendar.lastweek = data.contributions[52];
    gitcalendar.beforeweek = data.contributions[51];
    gitcalendar.thisdayindex = gitcalendar.lastweek.length - 1;
    gitcalendar.thisday = gitcalendar.lastweek[gitcalendar.thisdayindex].date;
    gitcalendar.oneyearbeforeday = gitcalendar.firstweek[0].date;
    gitcalendar.monthindex = gitcalendar.thisday.substring(5, 7) * 1;
    gitcalendar.montharrbefore = gitcalendar.month.splice(gitcalendar.monthindex, 12 - gitcalendar.monthindex);
    gitcalendar.monthchange = gitcalendar.montharrbefore.concat(gitcalendar.month);
    addweek(data);
    addlastmonth();
    responsiveChart();
  })
  .catch(function(error) {
    console.log(error);
  });

//手机版更换为svg绘制
if (document.getElementById("gitcalendarcanvasbox").offsetWidth < 500) {
  gitcalendar.simplemode = false
}

//当改变窗口大小时重新绘制canvas
window.onresize = function() {
  if (gitcalendar.simplemode) responsiveChart()
}

//解决滚动滑轮时出现的标签显示
window.onscroll = function() {
  if (document.querySelector('.angle-wrapper')) {
    document.querySelector('.angle-wrapper').style.display = 'none'
  }
};</script></div><script defer src="/live2d-widget/autoload.js"></script><script src = "/js/chatroom.js"></script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script><script>(function(w,d, s, id) {if(typeof(w.webpushr)!=='undefined') return;w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};var js, fjs = d.getElementsByTagName(s)[0];js = d.createElement(s); js.id = id;js.async=1;js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window,document, 'script', 'webpushr-jssdk'));webpushr('setup',{'key':'BKopqw2sndqlCRgR180vtiuWkmgwWUs-JztYwDNvno_kE7h9x2FYp7bLbT01h5rkgnAp_hGBA7MmYayEYDDLTfE' });</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="true" data-text="LOVE YOU ❤" data-fontsize="17px" data-random="false" async="async"></script><script src="//code.tidio.co/xi7xvcxspsj7k3k8gwzv5q2dyvsmhsyv.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>(function (w, d, s, id) {
            if (typeof (w.webpushr) !== 'undefined') return; w.webpushr = w.webpushr || function () { (w.webpushr.q = w.webpushr.q || []).push(arguments) }; var js, fjs = d.getElementsByTagName(s)[0]; js = d.createElement(s); js.id = id; js.async = 1; js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window, document, 'script', 'webpushr-jssdk'));webpushr('setup', { 'key': 'BKopqw2sndqlCRgR180vtiuWkmgwWUs-JztYwDNvno_kE7h9x2FYp7bLbT01h5rkgnAp_hGBA7MmYayEYDDLTfE' });</script></body></html>